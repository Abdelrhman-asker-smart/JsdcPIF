<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lead Form - Create</title>
    <link rel="stylesheet" href="./assets/css/style.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .error {
        border: 1px solid red !important;
      }

      .error-message {
        color: red;
        font-size: 12px;
        display: none;
      }

      button[disabled] {
        opacity: 0.6;
      }

      .floating-input {
        display: block;
        border: 1px solid #cae0f0;
        border-radius: 12px;
        padding: 1rem 0.625rem 0.2rem;
        width: 100%;
        font-size: 16px;
        color: #000;
        font-weight: 400;
        appearance: none;
        outline: none;
        transition: border-color 0.3s;
      }

      .floating-input:focus {
        border-color: #2563eb;
      }

      .floating-input:focus ~ .floating-label {
        color: #2563eb !important;
      }

      .floating-input::placeholder {
        color: transparent;
      }

      .floating-label {
        position: absolute;
        left: 0.625rem;
        top: 1rem;
        font-size: 12px;
        color: #bbb6b0;

        pointer-events: none;
        transition: transform 0.3s, color 0.3s;
        transform-origin: 0;
      }

      .floating-input:focus ~ .floating-label,
      .floating-input:not(:placeholder-shown) ~ .floating-label {
        transform: translateY(-1rem) scale(0.75);
        color: #bbb6b0;
        font-weight: 600;
      }

      select ~ .floating-label {
        position: absolute;
        left: 0.625rem;
        padding: 0;
        top: 2rem;
        color: #bbb6b0;
        pointer-events: none;
        transition: transform 0.3s, font-size 0.3s, top 0.3s;
        transform-origin: left top;
      }

      select:focus ~ .floating-label,
      select:not(:invalid) ~ .floating-label {
        top: 20px;
        font-size: 12px;
        color: #2563eb;
      }
      .LinksAdj .navbar-nav,
      li {
        color: white;
      }
      .dropdown-menu {
        min-width: fit-content;
      }
      .dropdown-item {
        color: white !important;
      }
      #dropdownToggle .dropdown-item {
        color: black !important;
      }
      #dropdownButton::after {
        display: inline-block;
        margin-left: 0.255em;
        vertical-align: 0.255em;
        content: "";
        border-top: 0.3em solid;
        border-right: 0.3em solid transparent;
        border-bottom: 0;
        border-left: 0.3em solid transparent;
      }
      .dropdown .nav-link {
        background-color: rgba(255, 255, 255, 0.1);
        padding: 0.5rem;
        border-radius: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        color: black;
      }
      .dropdown-menu {
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.2s ease-in-out, visibility 0.2s ease-in-out;
      }
      .dropdown-menu.open {
        opacity: 1;
        visibility: visible;
      }
      .respdrop {
        position: absolute;
        background-color: white;
        border-radius: 40px;
        top: 10vh;
        left: 50%;
        width: 100%;
        padding: 2rem;
        transform: translate(-50%, 10px);
        .dropdown-item {
          color: black !important;
          margin: auto;
        }
        #dropdownToggle {
          margin: auto;
        }
        ul {
          row-gap: 1rem;
          text-align: center;
        }
        #profileDropdownButton {
          margin: 1rem auto;
        }
        #dropdownMenu {
          left: 30% !important;
        }
      }
      #dropdownMenu {
        right: 0;
        top: 100%;
      }
      @media screen and (max-height: 500px) {
        .respdrop {
          top: 20vw !important;
        }
      }
      #dropdownToggle {
        background-color: rgba(255, 255, 255, 0.1);
        padding: 0.5rem;
        border-radius: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        color: black;
      }
    </style>
  </head>
  <body class="bg-[#EEF5FA]">
    <nav class="absolute top-0 left-0 w-screen h-[fit-content] p-4 z-[99]">
      <div class="container mx-auto flex justify-between items-center">
        <!-- Logo -->
        <div>
          <a href="/">
            <img
              src="../assets/images/Group 1.png"
              alt="Logo"
              class="w-auto"
              width="260px"
              height="70px"
            />
          </a>
        </div>

        <!-- Toggler Button (Mobile) -->
        <button
          id="navbarToggler"
          class="lg:hidden ps-5 p-2"
          aria-label="Toggle navigation"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16m-7 6h7"
            ></path>
          </svg>
        </button>

        <!-- Navbar Links -->
        <div
          id="navbarLinks"
          class="hidden ps-5 lg:flex lg:items-center lg:space-x-6"
        >
          <ul class="flex flex-col lg:flex-row lg:space-x-6">
            <li>
              <a
                href="/"
                class="text-[#88b651] hover:text-gray-700 dropdown-item"
                >Home</a
              >
            </li>
            <li>
              <a href="#" class="hover:text-gray-700 dropdown-item">Our Team</a>
            </li>
            <li>
              <a href="#" class="hover:text-gray-700 dropdown-item"
                >JSDC News</a
              >
            </li>
            <li>
              <a href="#" class="hover:text-gray-700 dropdown-item">Heriracy</a>
            </li>
            <li>
              <a href="../crm.html" class="hover:text-gray-700 dropdown-item"
                >JSDC CRM</a
              >
            </li>
            <li>
              <a href="#" class="hover:text-gray-700 dropdown-item"
                >Help Center</a
              >
            </li>
            <li>
              <a href="#" class="hover:text-gray-700 dropdown-item">Events</a>
            </li>
            <li>
              <a href="#" class="hover:text-gray-700 dropdown-item"
                >Internal Portal</a
              >
            </li>
          </ul>

          <!-- Profile Dropdown -->
          <li class="relative d-flex justify-content-center">
            <!-- Dropdown Toggle Button -->
            <button
              id="dropdownToggle"
              class="flex items-center space-x-2 focus:outline-none"
            >
              <img
                src="../assets/images/Ellipse 1.png"
                alt="pp"
                class="w-8 h-8 rounded-full"
              />
              <span class="dropdown-item">Aasker</span>
              <svg
                class="w-4 h-4 dropdown-item"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>

            <!-- Dropdown Menu -->
            <ul
              id="dropdownMenu"
              class="absolute mt-2 min-w-[fit-content] w-48 bg-white shadow-lg rounded-lg hidden"
            >
              <li>
                <a href="#" class="block px-4 py-2 hover:bg-gray-100 text-black"
                  >Action</a
                >
              </li>
              <li>
                <a href="#" class="block px-4 py-2 hover:bg-gray-100 text-black"
                  >Another action</a
                >
              </li>
              <li>
                <hr class="border-t my-1" />
              </li>
              <li>
                <a href="#" class="block px-4 py-2 hover:bg-gray-100 text-black"
                  >Something else here</a
                >
              </li>
            </ul>
          </li>
        </div>
      </div>
    </nav>
    <!-- Header Section -->
    <div
      class="h-[333px] flex items-center relative bg-center rounded-b-[60px] bg-cover"
      style="background-image: url('./assets/images/bgHero.png')"
    >
      <div
        class="absolute top-0 left-0 w-full h-full rounded-b-[60px]"
        style="
          background: linear-gradient(
            180deg,
            rgba(28, 107, 165, 0.7) 0%,
            rgba(103, 150, 222, 0.69) 50%
          );
        "
      ></div>
      <img
        class="absolute bottom-[-104px] right-0"
        src="./assets/images/bgHero2.svg"
        alt="Decorative"
      />
      <div class="container relative z-10">
        <h1 class="text-[32px] text-white font-bold">Crm</h1>
        <h2 class="text-[20px] font-bold text-white">
          home/<span class="text-[#CAE0F0]"> crm</span>
        </h2>
      </div>
    </div>
    <!-- Back Button -->
    <div class="container flex items-center gap-5 my-20">
      <svg
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g clip-path="url(#clip0_318_2435)">
          <path
            d="M22.5469 12H1.45312"
            stroke="#050504"
            stroke-width="3"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M11.2969 21.8438L1.45312 12L11.2969 2.15625"
            stroke="#050504"
            stroke-width="3"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </g>
        <defs>
          <clipPath id="clip0_318_2435">
            <rect
              width="24"
              height="24"
              fill="white"
              transform="matrix(-1 0 0 1 24 0)"
            />
          </clipPath>
        </defs>
      </svg>
      <a href="/crm.html?tab=lead" class="text-[#4E4E4E] font-semibold text-2xl"
        >back to srm</a
      >
    </div>
    <!-- Form Container -->
    <div class="container bg-white p-6 rounded-2xl shadow">
      <h1 class="text-2xl font-semibold text-[#0D0D0C]">Create Lead</h1>
      <hr class="my-4" />
      <form id="customerForm" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Customer -->
          <div class="relative">
            <input
              type="text"
              id="customer"
              placeholder=" "
              class="floating-input peer"
            />
            <label for="customer" class="floating-label">customer</label>
            <div class="error-message" id="customerError">
              This field is required.
            </div>
          </div>
          <!-- Name -->
          <div class="relative">
            <input
              type="text"
              id="Name"
              placeholder=" "
              class="floating-input peer"
            />
            <label for="Name" class="floating-label">Name</label>
            <div class="error-message" id="NameError">
              This field is required.
            </div>
          </div>
          <!-- Source -->
          <div class="relative">
            <input
              type="email"
              id="source"
              placeholder=" "
              class="floating-input peer"
            />
            <label for="source" class="floating-label">source</label>
            <div class="error-message" id="sourceError">
              Invalid email format.
            </div>
          </div>
          <!-- Description -->
          <div class="relative">
            <input
              type="url"
              id="Describtion"
              placeholder=" "
              class="floating-input peer"
            />
            <label for="Describtion" class="floating-label">Describtion</label>
            <div class="error-message" id="DescribtionError">
              Invalid URL format.
            </div>
          </div>
          <!-- Status -->
          <div class="relative">
            <select
              id="status"
              class="block w-full appearance-none rounded-lg floating-input text-base text-black font-normal border border-[#CAE0F0] focus:outline-none focus:ring-0 focus:border-blue-600 peer"
            >
              <option value="" selected disabled hidden>status</option>
              <option value="new">new</option>
              <option value="old">old</option>
            </select>
            <div class="error-message" id="statusError">
              This field is required.
            </div>
            <label for="status" class="floating-label">status</label>
            <!-- Dropdown arrow SVG remains unchanged -->
          </div>
          <!-- Priority -->
          <div class="relative">
            <select
              id="Priority"
              class="block w-full appearance-none rounded-lg floating-input text-base text-black font-normal border border-[#CAE0F0] focus:outline-none focus:ring-0 focus:border-blue-600 peer"
            >
              <option value="" selected disabled hidden>Priority</option>
              <option value="regular">low</option>
              <option value="vip">high</option>
            </select>
            <div class="error-message" id="PriorityError">
              This field is required.
            </div>
            <label for="Priority" class="floating-label">Priority</label>
            <!-- Dropdown arrow SVG remains unchanged -->
          </div>
        </div>
        <!-- Phone Numbers -->
        <div
          id="phoneNumbers"
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
        >
          <div class="phone-group relative">
            <input
              type="tel"
              id="phone0"
              placeholder=" "
              class="phone floating-input peer"
            />
            <label for="phone0" class="floating-label"
              >Contact Preferences</label
            >
            <!-- Fixed for="phone" to for="phone0" -->
            <div class="error-message phone-error">This field is required.</div>
          </div>
          <!-- Phone number add button remains unchanged -->
        </div>
        <!-- File Upload -->
        <div>
          <div
            id="fileDropArea"
            class="mt-1 border-2 border-dashed border-blue-500 rounded-md p-[35px] text-center bg-[#EEF5FA] cursor-pointer hover:bg-blue-100"
          >
            <input type="file" id="file" class="hidden" />
            <div class="flex flex-col justify-center items-center gap-[20px]">
              <span class="text-[#559BD0] font-[700] text-[20px]"
                >Drag&Drop your file or Browse</span
              >

              <svg
                width="103"
                height="102"
                viewBox="0 0 103 102"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g opacity="0.2">
                  <g clip-path="url(#clip0_318_2422)">
                    <path
                      d="M81.0829 0.182739H21.4211C15.772 0.189455 10.3562 2.41947 6.36167 6.38363C2.36714 10.3478 0.120048 15.7224 0.113281 21.3286L0.113281 80.5369C0.120048 86.1431 2.36714 91.5177 6.36167 95.4818C10.3562 99.446 15.772 101.676 21.4211 101.683H81.0829C86.732 101.676 92.1478 99.446 96.1423 95.4818C100.137 91.5177 102.384 86.1431 102.391 80.5369V21.3286C102.384 15.7224 100.137 10.3478 96.1423 6.38363C92.1478 2.41947 86.732 0.189455 81.0829 0.182739V0.182739ZM21.4211 8.64107H81.0829C84.4736 8.64107 87.7255 9.97779 90.1231 12.3572C92.5207 14.7365 93.8676 17.9636 93.8676 21.3286V80.5369C93.8603 82.4209 93.4232 84.2789 92.5891 85.9714L53.5405 47.2195C51.5618 45.2554 49.2126 43.6973 46.627 42.6343C44.0415 41.5712 41.2702 41.0241 38.4716 41.0241C35.6729 41.0241 32.9017 41.5712 30.3161 42.6343C27.7306 43.6973 25.3814 45.2554 23.4027 47.2195L8.6364 61.8694V21.3286C8.6364 17.9636 9.98336 14.7365 12.3809 12.3572C14.7785 9.97779 18.0304 8.64107 21.4211 8.64107ZM21.4211 93.2244C18.0304 93.2244 14.7785 91.8877 12.3809 89.5083C9.98336 87.129 8.6364 83.9018 8.6364 80.5369V73.8294L29.4243 53.1996C30.6116 52.0206 32.0213 51.0853 33.5729 50.4472C35.1246 49.8091 36.7877 49.4806 38.4673 49.4806C40.1469 49.4806 41.8101 49.8091 43.3617 50.4472C44.9133 51.0853 46.3231 52.0206 47.5104 53.1996L86.559 91.9557C84.8536 92.7834 82.9814 93.2171 81.0829 93.2244H21.4211Z"
                      fill="#374957"
                    />
                    <path
                      d="M68.2983 44.5875C71.2483 44.5875 74.132 43.7193 76.5849 42.0929C79.0377 40.4664 80.9494 38.1546 82.0784 35.4499C83.2073 32.7452 83.5027 29.7689 82.9271 26.8976C82.3516 24.0263 80.9311 21.3888 78.8451 19.3187C76.7591 17.2486 74.1014 15.8388 71.2081 15.2677C68.3148 14.6966 65.3158 14.9897 62.5904 16.11C59.8649 17.2304 57.5355 19.1276 55.8965 21.5618C54.2576 23.996 53.3828 26.8578 53.3828 29.7854C53.3828 33.7111 54.9543 37.4761 57.7515 40.252C60.5486 43.028 64.3424 44.5875 68.2983 44.5875ZM68.2983 23.4416C69.5626 23.4416 70.7985 23.8137 71.8497 24.5107C72.9009 25.2078 73.7202 26.1986 74.204 27.3577C74.6878 28.5169 74.8144 29.7924 74.5678 31.023C74.3211 32.2535 73.7123 33.3839 72.8183 34.2711C71.9244 35.1583 70.7853 35.7624 69.5454 36.0072C68.3054 36.252 67.0201 36.1264 65.852 35.6462C64.684 35.1661 63.6856 34.353 62.9832 33.3098C62.2808 32.2665 61.9059 31.04 61.9059 29.7854C61.9059 28.1029 62.5794 26.4893 63.7782 25.2997C64.977 24.11 66.6029 23.4416 68.2983 23.4416Z"
                      fill="#374957"
                    />
                  </g>
                </g>
                <defs>
                  <clipPath id="clip0_318_2422">
                    <rect
                      width="102.277"
                      height="101.5"
                      fill="white"
                      transform="translate(0.113281 0.182739)"
                    />
                  </clipPath>
                </defs>
              </svg>
              <p id="fileInputLabel"></p>
            </div>
          </div>
          <span
            id="currentFileNameSpan"
            class="mt-2 block text-sm text-gray-700"
          ></span>
          <div class="error-message" id="fileError">
            This field is required.
          </div>
        </div>
        <!-- Notes -->
        <div class="relative">
          <textarea
            id="notes"
            placeholder=" "
            class="block rounded-lg px-2.5 pb-2 pt-5 floating-input w-full text-base text-black font-normal border border-[#CAE0F0] appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer"
          ></textarea>
          <label for="notes" class="floating-label">Notes</label>
          <div class="error-message" id="notesError">
            This field is required.
          </div>
        </div>
        <!-- Submit Button -->
        <div class="flex gap-3 w-full flex-wrap">
          <button
            type="submit"
            id="submitButton"
            class="flex-grow bg-[#559BD0] text-white px-4 py-2 rounded-[8px] font-[700]"
          >
            Create
          </button>
          <button
            type="submit"
            id="submitButton"
            class="flex-grow bg-[#559BD0] text-white px-4 py-2 rounded-[8px] font-[700]"
          >
            Create , create another
          </button>
          <a
            href="./crm.html"
            class="border-[#559BD0] rounded-[8px] flex-grow text-[#559BD0] px-4 py-[8px] border text-center font-[700]"
            >Cancel</a
          >
        </div>
      </form>
      <!-- API Error Message -->
      <p id="apiError" class="mt-4 text-red-500"></p>
    </div>
    <script>
      let currentFileName = "";
      let phoneCounter = 1;

      function validateField(field) {
        const errorDiv = document.getElementById(field.id + "Error");
        let valid = true;

        if (field.tagName.toLowerCase() === "select") {
          valid = field.value !== "";
        } else if (field.type === "email") {
          valid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(field.value);
        } else if (field.type === "url") {
          valid = /^https?:\/\/.+\..+/.test(field.value);
        } else if (field.type === "file") {
          if (field.files && field.files.length > 0) {
            const file = field.files[0];
            if (file.size > 2 * 1024 * 1024) {
              valid = false;
              if (errorDiv) errorDiv.innerText = "File must be less than 2MB.";
            } else if (
              !["application/pdf", "image/jpeg", "image/png"].includes(
                file.type
              )
            ) {
              valid = false;
              if (errorDiv)
                errorDiv.innerText = "File must be a PDF or JPG/PNG.";
            } else {
              valid = true;
              if (errorDiv) errorDiv.innerText = "";
            }
          } else {
            valid = currentFileName !== "";
            if (!valid && errorDiv)
              errorDiv.innerText = "This field is required.";
          }
        } else {
          valid = field.value.trim() !== "";
        }

        if (!valid) {
          field.classList.add("error");
          if (errorDiv) errorDiv.style.display = "block";
        } else {
          field.classList.remove("error");
          if (errorDiv) errorDiv.style.display = "none";
        }
        return valid;
      }

      function addValidationListener(field) {
        if (field.tagName.toLowerCase() === "select" || field.type === "file") {
          field.addEventListener("change", () => validateField(field));
        } else {
          field.addEventListener("input", () => validateField(field));
        }
      }

      [
        "customer",
        "Name",
        "source",
        "Describtion",
        "status",
        "Priority",
        "file",
        "notes",
      ].forEach((id) => {
        const field = document.getElementById(id);
        if (field) addValidationListener(field);
      });

      // File handling (unchanged)
      const fileInput = document.getElementById("file");
      const fileDropArea = document.getElementById("fileDropArea");
      const fileInputLabel = document.getElementById("fileInputLabel");

      fileDropArea.addEventListener("click", () => fileInput.click());
      fileDropArea.addEventListener("dragover", (e) => {
        e.preventDefault();
        fileDropArea.classList.add("bg-blue-100");
      });
      fileDropArea.addEventListener("dragleave", (e) => {
        e.preventDefault();
        fileDropArea.classList.remove("bg-blue-100");
      });
      fileDropArea.addEventListener("drop", (e) => {
        e.preventDefault();
        fileDropArea.classList.remove("bg-blue-100");
        if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
          fileInput.files = e.dataTransfer.files;
          handleFileChange();
        }
      });
      fileInput.addEventListener("change", handleFileChange);

      function handleFileChange() {
        if (fileInput.files && fileInput.files.length > 0) {
          currentFileName = fileInput.files[0].name;
          fileInputLabel.textContent = "Selected File: " + currentFileName;
        } else {
          currentFileName = "";
          fileInputLabel.textContent = "Drag & Drop your file or Browse";
        }
        validateField(fileInput);
      }

      function attachPhoneValidation(input) {
        input.addEventListener("input", () => {
          const phoneGroup = input.closest(".phone-group");
          const errorDiv = phoneGroup.querySelector(".phone-error");
          if (input.value.trim() !== "") {
            input.classList.remove("error");
            errorDiv.style.display = "none";
          } else {
            input.classList.add("error");
            errorDiv.style.display = "block";
          }
        });
      }

      document.querySelectorAll(".phone").forEach((input) => {
        attachPhoneValidation(input);
      });

      function addPhoneNumber() {
        const phoneContainer = document.getElementById("phoneNumbers");
        if (!phoneContainer) {
          console.error("phoneNumbers container not found");
          return;
        }

        const newDiv = document.createElement("div");
        newDiv.className = "phone-group relative flex flex-col";

        const newInput = document.createElement("input");
        newInput.type = "tel";
        newInput.placeholder = " ";
        newInput.className = "phone floating-input peer";
        const newId = "phone" + phoneCounter;
        newInput.id = newId;

        const newLabel = document.createElement("label");
        newLabel.htmlFor = newId;
        newLabel.className = "floating-label";
        newLabel.innerText = "Contact Preferences";

        const errorDiv = document.createElement("div");
        errorDiv.className = "error-message phone-error mt-1";
        errorDiv.innerText = "This field is required.";

        newDiv.appendChild(newInput);
        newDiv.appendChild(newLabel);
        newDiv.appendChild(errorDiv);

        const iconContainer = document.createElement("div");
        iconContainer.className = "flex items-center justify-between mt-2";

        const deleteDiv = document.createElement("div");
        deleteDiv.className =
          "flex items-center gap-1 deleteBtn cursor-pointer";
        deleteDiv.innerHTML = `
              <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <!-- SVG content remains unchanged -->
              </svg>
              <p class='text-[12px] text-[#BBB6B0] font-[600]'>Delete</p>
          `;

        iconContainer.appendChild(deleteDiv);
        newDiv.appendChild(iconContainer);

        deleteDiv.onclick = function () {
          newDiv.remove();
        };

        const addBtnContainer =
          phoneContainer.querySelector(".phone-container");
        if (addBtnContainer) {
          phoneContainer.insertBefore(newDiv, addBtnContainer);
        } else {
          phoneContainer.appendChild(newDiv);
        }

        attachPhoneValidation(newInput);
        phoneCounter++;
        return newInput;
      }

      function sendData(formData) {
        return new Promise((resolve) => {
          setTimeout(() => {
            const errorOccurs = Math.random() < 0.5;
            if (errorOccurs) {
              resolve({ error: "API Error: Unable to update lead data." });
            } else {
              resolve({ success: true });
            }
          }, 500);
        });
      }

      document
        .getElementById("customerForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();
          let firstError = null;

          const fields = [
            "customer",
            "Name",
            "source",
            "Describtion",
            "status",
            "Priority",
            "file",
            "notes",
          ];

          fields.forEach((id) => {
            const field = document.getElementById(id);
            if (!validateField(field)) {
              field.classList.add("error");
              const errorDiv = document.getElementById(id + "Error");
              if (errorDiv) errorDiv.style.display = "block";
              if (!firstError) firstError = field;
            }
          });

          document.querySelectorAll(".phone").forEach((input) => {
            const phoneGroup = input.closest(".phone-group");
            const errorDiv = phoneGroup.querySelector(".phone-error");
            if (input.value.trim() === "") {
              input.classList.add("error");
              errorDiv.style.display = "block";
              if (!firstError) firstError = input;
            }
          });

          if (firstError) {
            firstError.focus();
          } else {
            const submitButtons = document.querySelectorAll("#submitButton");
            submitButtons.forEach((button) => {
              button.disabled = true;
              button.innerText = "Creating...";
            });

            const formData = new FormData();
            formData.append(
              "customer",
              document.getElementById("customer").value
            );
            formData.append("Name", document.getElementById("Name").value);
            formData.append("source", document.getElementById("source").value);
            formData.append(
              "Describtion",
              document.getElementById("Describtion").value
            );
            formData.append("status", document.getElementById("status").value);
            formData.append(
              "Priority",
              document.getElementById("Priority").value
            );
            formData.append("notes", document.getElementById("notes").value);

            if (fileInput.files && fileInput.files.length > 0) {
              formData.append("file", fileInput.files[0]);
            } else {
              formData.append("file", currentFileName);
            }

            document.querySelectorAll(".phone").forEach((input, index) => {
              formData.append(`phoneNumbers[${index}]`, input.value);
            });

            sendData(formData).then((response) => {
              submitButtons.forEach((button) => {
                button.disabled = false;
                button.innerText = button.dataset.originalText || "Create";
              });

              if (response.error) {
                document.getElementById("apiError").innerText = response.error;
              } else {
                document.getElementById("apiError").innerText = "";
                console.log("Lead Form Data:");
                for (const [key, value] of formData.entries()) {
                  console.log(key + ":", value);
                }
              }
            });
          }
        });

      document.querySelectorAll("#submitButton").forEach((button) => {
        button.dataset.originalText = button.innerText;
      });
    </script>
    <script>
      // Toggle Navbar Links on Mobile
      const navbarToggler = document.getElementById("navbarToggler");
      const navbarLinks = document.getElementById("navbarLinks");

      navbarToggler.addEventListener("click", () => {
        navbarLinks.classList.toggle("hidden");
        navbarLinks.classList.add("respdrop");
        navbarLinks.classList.add("container");
      });

      // Toggle Profile Dropdown
      const profileDropdownButton = document.getElementById(
        "profileDropdownButton"
      );
      const profileDropdownMenu = document.getElementById(
        "profileDropdownMenu"
      );

      profileDropdownButton.addEventListener("click", () => {
        profileDropdownMenu.classList.toggle("open");
      });

      // Close Dropdown When Clicking Outside
      document.addEventListener("click", (event) => {
        if (!profileDropdownButton.contains(event.target)) {
          profileDropdownMenu.classList.remove("open");
        }
      });
    </script>
    <script>
      // Get the dropdown toggle button and menu
      const dropdownToggle = document.getElementById("dropdownToggle");
      const dropdownMenu = document.getElementById("dropdownMenu");

      // Toggle dropdown visibility
      dropdownToggle.addEventListener("click", () => {
        dropdownMenu.classList.toggle("hidden");
      });

      // Close dropdown when clicking outside
      document.addEventListener("click", (event) => {
        if (
          !dropdownToggle.contains(event.target) &&
          !dropdownMenu.contains(event.target)
        ) {
          dropdownMenu.classList.add("hidden");
        }
      });
    </script>
  </body>
</html>
