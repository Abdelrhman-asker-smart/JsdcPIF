<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Customer Form - Update</title>
  <link rel="stylesheet" href="./assets/css/style.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Skeleton loader style */
    * {
      transition: all 1s;
    }

    .skeleton {
      background-color: #eee;
      border-radius: 4px;
      color: transparent;
      pointer-events: none;
      animation: skeleton-loading 1s linear infinite alternate;
    }

    @keyframes skeleton-loading {
      0% {
        opacity: 1;
      }

      100% {
        opacity: 0.5;
      }
    }

    .custom-alert {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .custom-alert.hidden {
      display: none;
    }

    .custom-alert-message {
      font-size: 16px;
      margin-bottom: 20px;
    }

    .custom-alert-close {
      background: #48bb78;
      border: none;
      padding: 10px 20px;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }

    .error {
      border: 1px solid red !important;
    }

    .error-message {
      color: red;
      font-size: 12px;
      display: none;
    }

    button[disabled] {
      opacity: 0.6;
    }

    .floating-input {
      display: block;
      border: 1px solid #cae0f0;
      border-radius: 12px;
      padding: 1rem 0.625rem 0.2rem;
      width: 100%;
      font-size: 16px;
      color: #000;
      font-weight: 400;
      appearance: none;
      outline: none;
      transition: border-color 0.3s;
    }

    .floating-input:focus {
      border-color: #2563eb;
    }

    .floating-input:focus~.floating-label {
      color: #2563eb !important;
    }

    .floating-input::placeholder {
      color: transparent;
    }

    .floating-label,
    select~.floating-label-select {
      position: absolute;
      left: 0.625rem;
      top: 1rem;
      font-size: 12px;
      color: #bbb6b0;

      pointer-events: none;
      transition: transform 0.3s, color 0.3s;
      transform-origin: 0;
    }

    .floating-input:focus~.floating-label,
    .floating-input:not(:placeholder-shown)~.floating-label {
      transform: translateY(-1rem) scale(0.75);
      color: #bbb6b0;
      font-weight: 600;
    }

    select:focus~.floating-label-select,
    select.float~.floating-label-select {
      position: absolute;
      left: 0.625rem;
      padding: 0;
      top: 2px;
      font-weight: 600;
      color: #bbb6b0;
      pointer-events: none;
      transition: transform 0.3s, font-size 0.3s, top 0.3s;
      transform-origin: left top;
      font-size: 10px !important;
    }

    select:focus~.floating-label-select {
      color: #2563eb;
    }

    select:focus~.floating-label,
    select:not(:invalid)~.floating-label {
      top: 20px;
      font-size: 12px;
      color: #2563eb;
    }
  </style>
  <style>
    /* TABLE & HEADER STYLES */
    #activity-table {
      border-collapse: separate;
      border-spacing: 0;
    }

    table {
      min-width: 940px;
    }

    #activity-table thead th {
      padding: 20px;
    }

    thead {
      background-color: #eef5fa;
    }

    table {
      width: 100%;
      margin-top: 1rem;
    }

    th,
    td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }

    td {
      color: #4e4e4e;
      padding: 20px;
    }

    /* ROUNDED CORNERS FOR FIRST & LAST TH */
    #activity-table thead tr th:first-child {
      border-top-left-radius: 8px;
      border-bottom-left-radius: 8px;
    }

    #activity-table thead tr th:last-child {
      border-top-right-radius: 8px;
      border-bottom-right-radius: 8px;
    }

    /* SORTING ICONS */
    .sortable .arrow-up,
    .sortable .arrow-down {
      display: block;
    }

    .sortable.asc .arrow-down {
      display: none;
    }

    .sortable.desc .arrow-up {
      display: none;
    }

    th.sortable {
      cursor: pointer;
    }

    /* CHECKBOX STYLING */
    .custom-checkbox {
      display: inline-flex;
      align-items: center;
      cursor: pointer;
    }

    .custom-checkbox input {
      display: none;
      /* Hide the default checkbox */
    }

    .custom-checkbox .checkmark {
      width: 24px;
      height: 24px;
      background-color: #eef5fa;
      border: 2px solid #cae0f0;
      border-radius: 4px;
      position: relative;
      transition: background-color 0.3s ease, border-color 0.3s ease;
    }

    /* Pinkish checked style */
    .custom-checkbox input:checked+.checkmark {
      background-color: #559bd0;
      /* light pink */
      border-color: #559bd0;
      /* salmon/pink border */
    }

    .custom-checkbox input:checked+.checkmark::after {
      content: "";
      position: absolute;
      left: 6px;
      top: 2px;
      width: 6px;
      height: 12px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }

    /* HIDING ELEMENTS */
    .hidden {
      display: none;
    }

    /* DELETE POPUP STYLES */
    #deleteConfirmationOverlay .trash-icon {
      width: 60px;
      height: 60px;
      margin: 0 auto 1rem;
      fill: #FCA5A5;
    }

    #deleteConfirmationOverlay p {
      margin-bottom: 1.5rem;
    }

    #btnCancelDelete {
      background-color: #E0F2FE;
      /* Light blue */
      color: #0284C7;
    }

    #btnConfirmDelete {
      background-color: #FEE2E2;
      /* Light pink */
      color: #DC2626;
    }
  </style>
</head>

<body class="bg-[#EEF5FA]">
  <!-- Header Section -->
  <div class="h-[333px] flex items-center relative bg-center rounded-b-[60px] bg-cover"
    style="background-image: url('./assets/images/bgHero.png')">
    <div class="absolute top-0 left-0 w-full h-full rounded-b-[60px]" style="
          background: linear-gradient(
            180deg,
            rgba(28, 107, 165, 0.7) 0%,
            rgba(103, 150, 222, 0.69) 50%
          );
        "></div>
    <img class="absolute bottom-[-104px] right-0" src="./assets/images/bgHero2.svg" alt="Decorative" />
    <div class="container relative z-10">
      <h1 class="text-[32px] text-white font-bold">Crm</h1>
      <h2 class="text-[20px] font-bold text-white">
        home/<span class="text-[#CAE0F0]"> crm</span>
      </h2>
    </div>
  </div>
  <!-- Back Button -->
  <a href="./crm.html" class="container flex items-center gap-5 my-14">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <g clip-path="url(#clip0_318_2435)">
        <path d="M22.5469 12H1.45312" stroke="#050504" stroke-width="3" stroke-linecap="round"
          stroke-linejoin="round" />
        <path d="M11.2969 21.8438L1.45312 12L11.2969 2.15625" stroke="#050504" stroke-width="3" stroke-linecap="round"
          stroke-linejoin="round" />
      </g>
      <defs>
        <clipPath id="clip0_318_2435">
          <rect width="24" height="24" fill="white" transform="matrix(-1 0 0 1 24 0)" />
        </clipPath>
      </defs>
    </svg>
    <p class="text-[#4E4E4E] font-semibold text-2xl">back to srm</p>
  </a>
  <div class="container ">
    <svg role="button" class="ml-auto mb-6 " style="transition: all .3s;" id="toggleForm" width="68" height="67"
      viewBox="0 0 68 67" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect x="33.6621" width="47.3239" height="47.3239" rx="11.831" transform="rotate(45 33.6621 0)" fill="#559BD0" />
      <path
        d="M42.0279 39.0399L36.4507 33.4627L42.0279 27.8856C42.3977 27.5158 42.6054 27.0142 42.6054 26.4913C42.6054 25.9683 42.3977 25.4668 42.0279 25.097C41.6581 24.7272 41.1565 24.5194 40.6336 24.5194C40.1106 24.5194 39.6091 24.7272 39.2393 25.097L33.6621 30.6742L28.0849 25.097C27.7151 24.7272 27.2136 24.5194 26.6906 24.5194C26.1677 24.5194 25.6661 24.7272 25.2963 25.097C24.9265 25.4668 24.7188 25.9683 24.7188 26.4913C24.7188 27.0142 24.9265 27.5158 25.2963 27.8856L30.8735 33.4627L25.2963 39.0399C24.9265 39.4097 24.7188 39.9113 24.7188 40.4342C24.7188 40.9572 24.9265 41.4587 25.2963 41.8285C25.6661 42.1983 26.1677 42.406 26.6906 42.406C27.2136 42.406 27.7151 42.1983 28.0849 41.8285L33.6621 36.2513L39.2393 41.8285C39.6091 42.1983 40.1106 42.406 40.6336 42.406C41.1565 42.406 41.6581 42.1983 42.0279 41.8285C42.3977 41.4587 42.6054 40.9572 42.6054 40.4342C42.6054 39.9113 42.3977 39.4097 42.0279 39.0399Z"
        fill="white" />
    </svg>

  </div>

  <!-- Form Container -->
  <div class="container bg-white p-6 rounded-2xl  mb-[30px] duration-[3000]" style="transition: all 1s;"
    id="customerFormContainer">
    <div class="flex items-center justify-between flex-wrap">
      <h1 class="text-2xl font-semibold text-[#0D0D0C]">Edit Customer</h1>
      <div class="flex gap-6 " id="customerBtns">
        <button class="bg-[#559BD0] text-white font-[600] p-[8px] rounded-[8px]">
          Convert to lead
        </button>
        <button class="bg-[#ffaea9] text-white font-[600] p-[8px] rounded-[8px]">
          delete customer </button>
      </div>
    </div>
    <hr class="my-4" />
    <form id="customerForm" class="space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Full Name -->
        <div class="relative">
          <input type="text" id="fullName" placeholder=" " class="floating-input peer skeleton" />
          <label for="fullName" class="floating-label">Full Name</label>
          <div class="error-message" id="fullNameError">
            This field is required.
          </div>
        </div>
        <!-- Last Name -->
        <div class="relative">
          <input type="text" id="lastName" placeholder=" " class="floating-input peer skeleton" />
          <label for="lastName" class="floating-label">Last Name</label>
          <div class="error-message" id="lastNameError">
            This field is required.
          </div>
        </div>
        <!-- Email -->
        <div class="relative">
          <input type="email" id="email" placeholder=" " class="floating-input peer skeleton" />
          <label for="email" class="floating-label">Email</label>
          <div class="error-message" id="emailError">
            Invalid email format.
          </div>
        </div>
        <!-- Website -->
        <div class="relative">
          <input type="url" id="website" placeholder=" " class="floating-input peer skeleton" />
          <label for="website" class="floating-label">Website</label>
          <div class="error-message" id="websiteError">
            Invalid URL format.
          </div>
        </div>
        <!-- Address -->
        <div class="relative">
          <input type="text" id="address" placeholder=" " class="floating-input peer skeleton" />
          <label for="address" class="floating-label">Address</label>
          <div class="error-message" id="addressError">
            This field is required.
          </div>
        </div>
        <!-- Customer Type -->
        <div class="relative">
          <select id="customerType"
            class="block w-full appearance-none rounded-[12px] floating-input text-base text-black font-normal border border-[#CAE0F0] focus:outline-none focus:ring-0 focus:border-blue-600 peer skeleton">
            <option value="" selected disabled hidden></option>
            <option value="regular">Regular</option>
            <option value="vip">VIP</option>
          </select>
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none h-fit top-[20px]">
            <svg width="16" height="10" viewBox="0 0 16 10" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M0.615384 1.87495L8.30769 9.56726L16 1.87495L14.9038 0.79803L8.30769 7.39418L1.71154 0.79803L0.615384 1.87495Z"
                fill="black" />
            </svg>
          </div>
          <label for="customerType" class="floating-label-select">Customer Type</label>

          <div class="error-message" id="customerTypeer skeletonror">
            This field is required.
          </div>
        </div>
      </div>
      <!-- Phone Numbers  -->
      <div id="phoneNumbers" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="phone-group relative">
          <input type="tel" id="phone0" placeholder=" " class="phone floating-input peer skeleton" />
          <label for="phone" class="floating-label">Phone Number</label>
          <div class="error-message phone-error">This field is required.</div>
        </div>
        <div class="flex flex-col gap-2 justify-center phone-container">
          <button type="button"
            class="border border-[#559BD0] text-[#559BD0] text-[16px] font-[600] p-[8px] rounded-[8px] flex gap-3 justify-center items-center"
            onclick="addPhoneNumber()">
            <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect y="0.182617" width="24" height="24" rx="4" fill="#559BD0" />
              <path
                d="M17 11.1826H13V7.18262C13 6.9174 12.8946 6.66305 12.7071 6.47551C12.5196 6.28797 12.2652 6.18262 12 6.18262C11.7348 6.18262 11.4804 6.28797 11.2929 6.47551C11.1054 6.66305 11 6.9174 11 7.18262V11.1826H7C6.73478 11.1826 6.48043 11.288 6.29289 11.4755C6.10536 11.663 6 11.9174 6 12.1826C6 12.4478 6.10536 12.7022 6.29289 12.8897C6.48043 13.0773 6.73478 13.1826 7 13.1826H11V17.1826C11 17.4478 11.1054 17.7022 11.2929 17.8897C11.4804 18.0773 11.7348 18.1826 12 18.1826C12.2652 18.1826 12.5196 18.0773 12.7071 17.8897C12.8946 17.7022 13 17.4478 13 17.1826V13.1826H17C17.2652 13.1826 17.5196 13.0773 17.7071 12.8897C17.8946 12.7022 18 12.4478 18 12.1826C18 11.9174 17.8946 11.663 17.7071 11.4755C17.5196 11.288 17.2652 11.1826 17 11.1826Z"
                fill="white" />
            </svg>
            Add to phone number
          </button>
          <p class="text-[12px] font-[600] text-[#BBB6B0] text-center">
            you can add more than phone number
          </p>
        </div>
      </div>

      <div>
        <div id="fileDropArea"
          class="mt-1 border-2 border-dashed border-blue-500 rounded-md p-[35px] text-center bg-[#EEF5FA] cursor-pointer hover:bg-blue-100">
          <input type="file" id="file" class="hidden" />
          <div class="flex flex-col justify-center items-center gap-[20px]">
            <span class="text-[#559BD0] font-[700] text-[20px]" id="fileInputLabel">Drag&Drop your file or Browse</span>
            <div id="fileDropAreaImage">
              <svg width="103" height="102" viewBox="0 0 103 102" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g opacity="0.2">
                  <g clip-path="url(#clip0_318_2422)">
                    <path
                      d="M81.0829 0.182739H21.4211C15.772 0.189455 10.3562 2.41947 6.36167 6.38363C2.36714 10.3478 0.120048 15.7224 0.113281 21.3286L0.113281 80.5369C0.120048 86.1431 2.36714 91.5177 6.36167 95.4818C10.3562 99.446 15.772 101.676 21.4211 101.683H81.0829C86.732 101.676 92.1478 99.446 96.1423 95.4818C100.137 91.5177 102.384 86.1431 102.391 80.5369V21.3286C102.384 15.7224 100.137 10.3478 96.1423 6.38363C92.1478 2.41947 86.732 0.189455 81.0829 0.182739V0.182739ZM21.4211 8.64107H81.0829C84.4736 8.64107 87.7255 9.97779 90.1231 12.3572C92.5207 14.7365 93.8676 17.9636 93.8676 21.3286V80.5369C93.8603 82.4209 93.4232 84.2789 92.5891 85.9714L53.5405 47.2195C51.5618 45.2554 49.2126 43.6973 46.627 42.6343C44.0415 41.5712 41.2702 41.0241 38.4716 41.0241C35.6729 41.0241 32.9017 41.5712 30.3161 42.6343C27.7306 43.6973 25.3814 45.2554 23.4027 47.2195L8.6364 61.8694V21.3286C8.6364 17.9636 9.98336 14.7365 12.3809 12.3572C14.7785 9.97779 18.0304 8.64107 21.4211 8.64107ZM21.4211 93.2244C18.0304 93.2244 14.7785 91.8877 12.3809 89.5083C9.98336 87.129 8.6364 83.9018 8.6364 80.5369V73.8294L29.4243 53.1996C30.6116 52.0206 32.0213 51.0853 33.5729 50.4472C35.1246 49.8091 36.7877 49.4806 38.4673 49.4806C40.1469 49.4806 41.8101 49.8091 43.3617 50.4472C44.9133 51.0853 46.3231 52.0206 47.5104 53.1996L86.559 91.9557C84.8536 92.7834 82.9814 93.2171 81.0829 93.2244H21.4211Z"
                      fill="#374957" />
                    <path
                      d="M68.2983 44.5875C71.2483 44.5875 74.132 43.7193 76.5849 42.0929C79.0377 40.4664 80.9494 38.1546 82.0784 35.4499C83.2073 32.7452 83.5027 29.7689 82.9271 26.8976C82.3516 24.0263 80.9311 21.3888 78.8451 19.3187C76.7591 17.2486 74.1014 15.8388 71.2081 15.2677C68.3148 14.6966 65.3158 14.9897 62.5904 16.11C59.8649 17.2304 57.5355 19.1276 55.8965 21.5618C54.2576 23.996 53.3828 26.8578 53.3828 29.7854C53.3828 33.7111 54.9543 37.4761 57.7515 40.252C60.5486 43.028 64.3424 44.5875 68.2983 44.5875ZM68.2983 23.4416C69.5626 23.4416 70.7985 23.8137 71.8497 24.5107C72.9009 25.2078 73.7202 26.1986 74.204 27.3577C74.6878 28.5169 74.8144 29.7924 74.5678 31.023C74.3211 32.2535 73.7123 33.3839 72.8183 34.2711C71.9244 35.1583 70.7853 35.7624 69.5454 36.0072C68.3054 36.252 67.0201 36.1264 65.852 35.6462C64.684 35.1661 63.6856 34.353 62.9832 33.3098C62.2808 32.2665 61.9059 31.04 61.9059 29.7854C61.9059 28.1029 62.5794 26.4893 63.7782 25.2997C64.977 24.11 66.6029 23.4416 68.2983 23.4416Z"
                      fill="#374957" />
                  </g>
                </g>
                <defs>
                  <clipPath id="clip0_318_2422">
                    <rect width="102.277" height="101.5" fill="white" transform="translate(0.113281 0.182739)" />
                  </clipPath>
                </defs>
              </svg>
            </div>
          </div>
        </div>
        <span id="currentFileNameSpan" class="mt-2 block text-sm text-gray-700"></span>
        <div class="error-message" id="fileError">
          This field is required.
        </div>
      </div>
      <!-- Notes Field  -->
      <div class="relative">
        <textarea id="notes" placeholder=" "
          class="block rounded-lg px-2.5 pb-2 pt-5 floating-input w-full text-base text-black font-normal border border-[#CAE0F0] appearance-none focus:outline-none focus:ring-0 focus:border-blue-600 peer skeleton h-[132px]"></textarea>
        <label for="notes" class="floating-label">Notes</label>
        <div class="error-message" id="notesError">
          This field is required.
        </div>
      </div>
      <!-- Submit Button -->
      <div class="flex gap-3 w-full flex-wrap">
        <button type="submit" id="submitButton"
          class="flex-grow bg-[#559BD0] text-white px-4 py-2 rounded-[8px] font-[700]">
          save changes
        </button>

        <a href="./crm.html"
          class="border-[#559BD0] rounded-[8px] flex-grow text-[#559BD0] px-4 py-[8px] border text-center font-[700]">Cancel</a>
      </div>
    </form>
    <!-- API Error Message -->
    <p id="apiError" class="mt-4 text-white bg-red-500 p-3 rounded-[10px] hidden"></p>
  </div>
  <!-- Custom Success Alert -->
  <div id="customAlert" class="custom-alert hidden wow animate__animated animate__fadeInUp">
    <div
      class="custom-alert-content bg-white p-5 flex rounded-lg text-center max-w-[400px] shadow-[0_2px_8px_rgba(0,0,0,0.3)] flex-col items-center">
      <div
        class="custom-alert-icon mb-[20px] text-[50px] rounded-full text-white bg-[#559BD0] text[#fff] w-[75px] h-[75px]">
        &#10003;
      </div>
      <h2 class="text-xl font-bold mb-1">User updated Successfully</h2>
      <p class="text-base mb-4">Your form has been successfully submitted!</p>
    </div>
  </div>




  <!-- table activity -->
  <div class="container !p-0 " id="activities">
      <svg role="button" class="ml-auto mb-6 " style="transition: all .3s;" id="toggleactivities" width="68" height="67"
        viewBox="0 0 68 67" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="33.6621" width="47.3239" height="47.3239" rx="11.831" transform="rotate(45 33.6621 0)"
          fill="#559BD0" />
        <path
          d="M42.0279 39.0399L36.4507 33.4627L42.0279 27.8856C42.3977 27.5158 42.6054 27.0142 42.6054 26.4913C42.6054 25.9683 42.3977 25.4668 42.0279 25.097C41.6581 24.7272 41.1565 24.5194 40.6336 24.5194C40.1106 24.5194 39.6091 24.7272 39.2393 25.097L33.6621 30.6742L28.0849 25.097C27.7151 24.7272 27.2136 24.5194 26.6906 24.5194C26.1677 24.5194 25.6661 24.7272 25.2963 25.097C24.9265 25.4668 24.7188 25.9683 24.7188 26.4913C24.7188 27.0142 24.9265 27.5158 25.2963 27.8856L30.8735 33.4627L25.2963 39.0399C24.9265 39.4097 24.7188 39.9113 24.7188 40.4342C24.7188 40.9572 24.9265 41.4587 25.2963 41.8285C25.6661 42.1983 26.1677 42.406 26.6906 42.406C27.2136 42.406 27.7151 42.1983 28.0849 41.8285L33.6621 36.2513L39.2393 41.8285C39.6091 42.1983 40.1106 42.406 40.6336 42.406C41.1565 42.406 41.6581 42.1983 42.0279 41.8285C42.3977 41.4587 42.6054 40.9572 42.6054 40.4342C42.6054 39.9113 42.3977 39.4097 42.0279 39.0399Z"
          fill="white" />
      </svg>

    <div class="bg-white p-6 rounded-[15px] mb-[40px]" id="activitiesContainer">
      <div class="flex justify-between flex-wrap items-center">
        <h3 class="text-2xl font-semibold text-black mb-6">activities</h3>
        <div class="gap-6 flex flex-wrap" id="activitiesBtns">
          <button id="btnNewActivity"
          onclick="showPopUp()"
            class="bg-[#559BD0] font-[700] text-white px-10 border border-[#559BD0] py-2 rounded-[8px]">
            New Activity </button>
        </div>
      </div>

      <div class="flex gap-3 items-center p-3 border border-[#E6F0F8] rounded-[12px] mt-6 ml-auto w-fit px-6">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_314_994)">
            <path
              d="M15.8045 14.8625L11.8252 10.8831C12.9096 9.55686 13.4428 7.86453 13.3144 6.15617C13.1861 4.44782 12.406 2.85415 11.1356 1.70481C9.86516 0.555472 8.20158 -0.0616068 6.48895 -0.0187856C4.77632 0.0240356 3.14566 0.723481 1.93426 1.93487C0.72287 3.14627 0.0234252 4.77693 -0.019396 6.48956C-0.0622172 8.20219 0.554862 9.86577 1.7042 11.1362C2.85354 12.4066 4.44721 13.1867 6.15556 13.315C7.86392 13.4434 9.55625 12.9102 10.8825 11.8258L14.8619 15.8051C14.9876 15.9266 15.156 15.9938 15.3308 15.9922C15.5056 15.9907 15.6728 15.9206 15.7964 15.797C15.92 15.6734 15.9901 15.5062 15.9916 15.3314C15.9932 15.1566 15.926 14.9882 15.8045 14.8625ZM6.66652 12.0005C5.61169 12.0005 4.58054 11.6877 3.70348 11.1016C2.82642 10.5156 2.14283 9.68265 1.73916 8.70811C1.3355 7.73357 1.22988 6.66122 1.43567 5.62665C1.64145 4.59208 2.14941 3.64178 2.89529 2.8959C3.64117 2.15002 4.59147 1.64206 5.62604 1.43628C6.6606 1.23049 7.73296 1.33611 8.7075 1.73977C9.68204 2.14344 10.515 2.82703 11.101 3.70409C11.6871 4.58115 11.9999 5.6123 11.9999 6.66713C11.9983 8.08113 11.4359 9.43676 10.436 10.4366C9.43615 11.4365 8.08052 11.9989 6.66652 12.0005Z"
              fill="#559BD0" />
          </g>
          <defs>
            <clipPath id="clip0_314_994">
              <rect width="16" height="16" fill="white" />
            </clipPath>
          </defs>
        </svg>

        <input placeholder="search" class="border-0 text-[#CAE0F0] placeholder:text-[#CAE0F0]">
      </div>

      <!-- Table -->
      <div class="overflow-x-auto toggleActivitiesHidden" id="toggleActivitiesHidden">
        <table id="activity-table" class="min-w-full">
          <thead>
            <tr>
              <th class="p-2 text-center">
                <label class="custom-checkbox">
                  <input type="checkbox" id="activity-select-all">
                  <span class="checkmark"></span>
                </label>
              </th>
              <!-- Email header with sort icons -->
              <th class="p-2 text-left cursor-pointer sortable" data-column="email">
                <div class="flex items-center gap-2">
                  <span>Email</span>
                  <div class="flex flex-col arrows inline-flex h-[40px] justify-center">
                    <svg class="arrow-up" width="16" style="rotate: 180deg" height="10" viewBox="0 0 16 10" fill="none"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M0.000149727 1.69234L7.69246 9.38464L15.3848 1.69234L14.2886 0.615413L7.69246 7.21157L1.0963 0.615413L0.000149727 1.69234Z"
                        fill="black" />
                    </svg>
                    <svg class="arrow-down" width="16" height="10" viewBox="0 0 16 10" fill="none"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M0.000149727 1.69234L7.69246 9.38464L15.3848 1.69234L14.2886 0.615413L7.69246 7.21157L1.0963 0.615413L0.000149727 1.69234Z"
                        fill="black" />
                    </svg>
                  </div>
                </div>
              </th>
              <!-- Date header with sort icons -->
              <th class="p-2 text-left cursor-pointer sortable" data-column="date">
                <div class="flex items-center gap-2">
                  <span>Date</span>
                  <div class="flex flex-col arrows inline-flex h-[40px] justify-center">
                    <svg class="arrow-up" width="16" style="rotate: 180deg" height="10" viewBox="0 0 16 10" fill="none"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M0.000149727 1.69234L7.69246 9.38464L15.3848 1.69234L14.2886 0.615413L7.69246 7.21157L1.0963 0.615413L0.000149727 1.69234Z"
                        fill="black" />
                    </svg>
                    <svg class="arrow-down" width="16" height="10" viewBox="0 0 16 10" fill="none"
                      xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M0.000149727 1.69234L7.69246 9.38464L15.3848 1.69234L14.2886 0.615413L7.69246 7.21157L1.0963 0.615413L0.000149727 1.69234Z"
                        fill="black" />
                    </svg>
                  </div>
                </div>
              </th>
              <!-- Notes header with sort icons -->
              <th class="p-2 text-left cursor-pointer sortable" data-column="notes">
                <div class="flex items-center gap-2">
                  <span>Notes</span>
                </div>
              </th>
              <!-- Created By header with sort icons -->
              <th class="p-2 text-left cursor-pointer sortable" data-column="createdBy">
                <div class="flex items-center gap-2">
                  <span>Created By</span>
                </div>
              </th>
              <th class="p-2 text-center"></th>
            </tr>
          </thead>
          <tbody id="activity-table-body"></tbody>
        </table>
      </div>

      <!-- Pagination Controls (Styled like your snippet) -->
      <div class="flex items-center justify-end mt-4 toggleActivitiesHidden">
        <button id="activity-prevPage"
          class="h-[24px] p-[4px] w-[24px] rounded-[3px_0px_0px_3px] text-gray-400 bg-gray-200 cursor-not-allowed"
          disabled>
          <img src="./assets/images/icons8-arrow-50 (1).png" class="w-full h-full" alt="prev page" />
        </button>
        <button id="activity-nextPage"
          class="h-[24px] w-[24px] p-[4px] mx-auto inline-block rounded-[0px_3px_3px_0px] text-white bg-[#559BD0]">
          <img src="./assets/images/icons8-arrow-50 (1).png" style="rotate: 180deg;" class="w-full h-full"
            alt="next page" />
        </button>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="flex justify-between items-center mb-[50px] mt-4 toggleActivitiesHidden">
      <div class="flex items-center gap-6 justify-center flex-grow flex-wrap" id="paginationLimit">
        <p id="lead-resultsText"
          class="flex-grow max-w-[194px] w-full text-center bg-white text-[#4E4E4E] font-bold rounded-[12px] h-[60px] flex items-center justify-center"
          style="box-shadow: 0px 12px 20px 0px #00000014;">
          showing 1 result
        </p>
        <div class="flex-grow max-w-[194px] w-full text-center relative">
          <button id="lead-perPageButton"
            class="bg-white text-[#4E4E4E] rounded-[12px] h-[60px] w-full flex items-center justify-center"
            style="box-shadow: 0px 12px 20px 0px #00000014">
            per page <strong id="lead-perPageValue" class="text-[#050504] mx-2">10</strong>
          </button>
          <div id="lead-perPageDropdown"
            class="hidden absolute mt-3 left-0 top-full w-full bg-white border rounded-[12px] shadow-md z-10">
            <div class="option py-2 cursor-pointer text-black" data-value="10">10</div>
            <div class="option py-2 cursor-pointer text-black" data-value="5">5</div>
            <div class="option py-2 cursor-pointer text-black" data-value="20">20</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Popup Overlay for Add/Edit Activity -->
    <div id="popupOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center ">
      <div class="bg-white p-6 rounded-[24px] max-w-md w-full relative">
        <!-- Close Button -->
 <!-- Close Icon -->
 <button id="popupCloseBtn"
 class="absolute w-[40px] h-[40px] rounded-full flex justify-center items-center top-[-17px] right-[-12px] bg-white text-gray-600 text-lg"
 style="box-shadow: 0px 4px 4px 0px #00000014;
"><svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path
     d="M13.4432 10.7734L9.34069 6.90239L13.2117 2.79986C13.4683 2.52784 13.6064 2.16501 13.5956 1.79118C13.5847 1.41735 13.4258 1.06314 13.1538 0.806481C12.8818 0.549818 12.5189 0.411725 12.1451 0.422581C11.7713 0.433437 11.4171 0.592351 11.1604 0.864366L7.28943 4.96689L3.1869 1.09591C2.91488 0.839245 2.55205 0.701152 2.17822 0.712008C1.80439 0.722863 1.45018 0.881778 1.19352 1.15379C0.936857 1.42581 0.798765 1.78864 0.80962 2.16247C0.820476 2.5363 0.97939 2.89051 1.2514 3.14717L5.35393 7.01816L1.48295 11.1207C1.22628 11.3927 1.08819 11.7555 1.09905 12.1294C1.1099 12.5032 1.26882 12.8574 1.54083 13.1141C1.81285 13.3707 2.17568 13.5088 2.54951 13.498C2.92334 13.4871 3.27755 13.3282 3.53421 13.0562L7.4052 8.95365L11.5077 12.8246C11.7797 13.0813 12.1426 13.2194 12.5164 13.2085C12.8902 13.1977 13.2444 13.0388 13.5011 12.7668C13.7578 12.4947 13.8959 12.1319 13.885 11.7581C13.8741 11.3842 13.7152 11.03 13.4432 10.7734Z"
     fill="#DBDBDB" />
 </svg>
</button>    
<form id="activityForm">
  <!-- Floating label for Email -->
  <div class="relative z-0 w-full mb-4 group">
    <input
      type="email"
      id="activityEmail"
      name="email"
      class=" block   w-full  text-gray-900 bg-transparent border rounded-[12px] p-[15px_16px] border-[#CAE0F0] appearance-none focus:outline-none focus:ring-0 focus:border-[#559BD0] peer"
      placeholder=" "
      required
    />
    <label
      for="activityEmail"
      class="absolute text-[16px] text-gray-500 duration-300 transform -translate-y-6 scale-75 top-[16px] left-[8px] -z-10 origin-[0] peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:text-[12px]  peer-focus:-translate-y-2"
    >
      Email
    </label>
    <p id="emailError" class="text-red-500 text-xs mt-1 hidden"></p>
  </div>

  <!-- Floating label for Date -->
  <div class="relative z-0 w-full mb-4 group">
    <input
      type="date"
      id="activityDate"
      name="date"
      class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none focus:outline-none focus:ring-0 focus:border-[#559BD0] peer"
      placeholder=" "
      required
    />
    <label
      for="activityDate"
      class="absolute text-sm text-gray-500 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
    >
      Date
    </label>
    <p id="dateError" class="text-red-500 text-xs mt-1 hidden"></p>
  </div>

  <!-- Floating label for Notes -->
  <div class="relative z-0 w-full mb-4 group">
    <textarea
    id="activityNotes"
    name="notes"
    rows="4"
    class="block w-full text-sm text-gray-900 bg-transparent border border-gray-300 rounded-[12px] py-[15px] px-[16px] appearance-none focus:outline-none focus:ring-0 focus:border-[#559BD0] peer"
    placeholder=" "
    required
  ></textarea>
  <label
    for="activityNotes"
    class="absolute duration-300 transform -translate-y-2  top-3 -z-10 origin-[0] text-[12px] text-[#BBB6B0] 
           peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-placeholder-shown:text-[16px] 
            peer-focus:-translate-y-2 peer-focus:text-[12px] focus:text-[12px] peer-focus:font-[600] focus:font-[600]"
  >
    Notes
  </label>
  
    <p id="notesError" class="text-red-500 text-xs mt-1 hidden"></p>
  </div>

  <p id="errorMsg" class="text-sm text-red-500 mb-2"></p>

  <div class="flex gap-4">
    <button
      type="submit"
      id="btnSaveChanges"
      class="text-[16px] font-[700] bg-[#559BD0] text-white p-[8px] rounded flex-grow"
    >
      Save Changes
    </button>
    <button
      type="button"
      id="btnCancelPopup"
      class="bg-white text-[#559BD0] border border-[#559BD0] p-[8px] text-[16px] font-[700] rounded flex-grow"
    >
      Cancel
    </button>
  </div>
</form>

      </div>
    </div>

    <!-- Popup Overlay for Confirm Delete -->
    <div id="deleteConfirmationOverlay"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
      <div class="bg-white p-6 rounded max-w-sm w-full relative text-center">
        <button id="deletePopupCloseBtn" class="absolute top-2 right-2 text-gray-600 text-2xl">&times;</button>
        <!-- Trash icon -->
        <svg class="trash-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M9 3V4H4V6H5V19C5 20.65 6.35 22 8 22H16C17.65 22 19 20.65 19 19V6H20V4H15V3C15 1.9 14.1 1 13 1H11C9.9 1 9 1.9 9 3ZM11 3H13V4H11V3ZM17 6V19C17 19.55 16.55 20 16 20H8C7.45 20 7 19.55 7 19V6H17Z" />
        </svg>
        <p class="text-lg mb-6">
          Are you sure you would like to <span class="text-red-500">delete</span> this item?
        </p>
        <div class="flex justify-center gap-4">
          <button id="btnCancelDelete" class="px-4 py-2 rounded">Cancel</button>
          <button id="btnConfirmDelete" class="px-4 py-2 rounded">Yes, Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Popup Overlay -->
  <div id="popupOverlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
    <div class="bg-white p-6 rounded max-w-md w-full relative">
      <!-- Close Button -->
      <button id="popupCloseBtn" class="absolute top-2 right-2 text-gray-600 text-2xl">&times;</button>
      <h3 class="text-xl font-bold mb-4">Activity Details</h3>
      <form id="activityForm">
        <div class="mb-4">
          <label for="activityEmail" class="block text-sm font-medium text-gray-700">Email</label>
          <input type="email" id="activityEmail" name="email" required
            class="mt-1 block w-full border border-gray-300 rounded-md p-2">
        </div>
        <div class="mb-4">
          <label for="activityNotes" class="block text-sm font-medium text-gray-700">Notes</label>
          <textarea id="activityNotes" name="notes" required
            class="mt-1 block w-full border border-gray-300 rounded-md p-2"></textarea>
        </div>
        <div class="mb-4">
          <label for="activityDate" class="block text-sm font-medium text-gray-700">Date</label>
          <input type="date" id="activityDate" name="date" required
            class="mt-1 block w-full border border-gray-300 rounded-md p-2">
        </div>
        <p id="errorMsg" class="text-sm text-red-500 mb-2"></p>
        <div class="flex gap-4">
          <button type="submit" id="btnSaveChanges" class="bg-blue-500 text-white px-4 py-2 rounded">
            Save Changes
          </button>
          <button type="button" id="btnCancelPopup" class="bg-gray-300 text-gray-700 px-4 py-2 rounded">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    let activities = [
      { id: 1, email: "oli@example.com", notes: "Important client", date: "2025-03-10", createdBy: "oli", selected: false },
      { id: 2, email: "mary@example.com", notes: "Follow up", date: "2025-03-12", createdBy: "mary", selected: false },
      { id: 3, email: "john@example.com", notes: "New lead", date: "2025-03-11", createdBy: "john", selected: false },
      { id: 4, email: "sara@example.com", notes: "Call back", date: "2025-03-13", createdBy: "sara", selected: false },
      { id: 5, email: "alex@example.com", notes: "Meeting scheduled", date: "2025-03-14", createdBy: "alex", selected: false },
      { id: 6, email: "linda@example.com", notes: "Interested", date: "2025-03-15", createdBy: "linda", selected: false },
      { id: 7, email: "peter@example.com", notes: "Demo requested", date: "2025-03-16", createdBy: "peter", selected: false },
      { id: 8, email: "anna@example.com", notes: "Need more info", date: "2025-03-17", createdBy: "anna", selected: false },
      { id: 9, email: "mike@example.com", notes: "Follow up", date: "2025-03-18", createdBy: "mike", selected: false },
      { id: 10, email: "laura@example.com", notes: "Contract sent", date: "2025-03-19", createdBy: "laura", selected: false },
      { id: 11, email: "james@example.com", notes: "Interested", date: "2025-03-20", createdBy: "james", selected: false },
      { id: 12, email: "emma@example.com", notes: "Meeting arranged", date: "2025-03-21", createdBy: "emma", selected: false },
      { id: 13, email: "oliver@example.com", notes: "Needs follow-up", date: "2025-03-22", createdBy: "oliver", selected: false },
      { id: 14, email: "ava@example.com", notes: "Sent proposal", date: "2025-03-23", createdBy: "ava", selected: false },
      { id: 15, email: "noah@example.com", notes: "Call scheduled", date: "2025-03-24", createdBy: "noah", selected: false },
      { id: 16, email: "mia@example.com", notes: "Awaiting response", date: "2025-03-25", createdBy: "mia", selected: false },
      { id: 17, email: "lucas@example.com", notes: "Demo requested", date: "2025-03-26", createdBy: "lucas", selected: false },
      { id: 18, email: "sophia@example.com", notes: "Follow up", date: "2025-03-27", createdBy: "sophia", selected: false },
      { id: 19, email: "jack@example.com", notes: "New inquiry", date: "2025-03-28", createdBy: "jack", selected: false },
      { id: 20, email: "amelia@example.com", notes: "Interested", date: "2025-03-29", createdBy: "amelia", selected: false }
    ];

    // Global variables
    let currentEditId = null;
    let currentDeleteId = null;
    let rowsPerPage = 10;
    let currentPage = 0;
    const sortState = { email: 1, date: 1, notes: 1, createdBy: 1 };

    // Element references
    const btnNewActivity = document.getElementById("btnNewActivity");
    const popupOverlay = document.getElementById("popupOverlay");
    const popupCloseBtn = document.getElementById("popupCloseBtn");
    const btnCancelPopup = document.getElementById("btnCancelPopup");
    const activityForm = document.getElementById("activityForm");
    const errorMsg = document.getElementById("errorMsg");

    const tableBody = document.getElementById("activity-table-body");
    const selectAll = document.getElementById("activity-select-all");
    const prevButton = document.getElementById("activity-prevPage");
    const nextButton = document.getElementById("activity-nextPage");
    const resultsText = document.getElementById("lead-resultsText");
    const perPageButton = document.getElementById("lead-perPageButton");
    const perPageValue = document.getElementById("lead-perPageValue");
    const perPageDropdown = document.getElementById("lead-perPageDropdown");

    // Delete popup references
    const deleteConfirmationOverlay = document.getElementById("deleteConfirmationOverlay");
    const deletePopupCloseBtn = document.getElementById("deletePopupCloseBtn");
    const btnCancelDelete = document.getElementById("btnCancelDelete");
    const btnConfirmDelete = document.getElementById("btnConfirmDelete");
function showPopUp(){
  currentEditId = null;
      activityForm.reset();
      errorMsg.textContent = "";
      popupOverlay.classList.remove("hidden");
}
    /* --- Popup for Add/Edit Activity --- */
    btnNewActivity.addEventListener("click", () => {
      console.log("btnNewActivitybtnNewActivity")
      currentEditId = null;
      activityForm.reset();
      errorMsg.textContent = "";
      popupOverlay.classList.remove("hidden");
    });
    function closePopup() {
      popupOverlay.classList.add("hidden");
    }
    popupCloseBtn.addEventListener("click", closePopup);
    btnCancelPopup.addEventListener("click", closePopup);

    // Live validation for each input field
    const emailInput = document.getElementById("activityEmail");
    const notesInput = document.getElementById("activityNotes");
    const dateInput = document.getElementById("activityDate");
    const emailError = document.getElementById("emailError");
    const notesError = document.getElementById("notesError");
    const dateError = document.getElementById("dateError");

    function validateEmail() {
      const emailValue = emailInput.value.trim();
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (emailValue === "") {
        emailError.textContent = "Email is required.";
        emailError.classList.remove("hidden");
        emailInput.classList.add("border-red-500");
        return false;
      } else if (!emailRegex.test(emailValue)) {
        emailError.textContent = "Please enter a valid email.";
        emailError.classList.remove("hidden");
        emailInput.classList.add("border-red-500");
        return false;
      } else {
        emailError.textContent = "";
        emailError.classList.add("hidden");
        emailInput.classList.remove("border-red-500");
        return true;
      }
    }

    function validateNotes() {
      const notesValue = notesInput.value.trim();
      if (notesValue === "") {
        notesError.textContent = "Notes are required.";
        notesError.classList.remove("hidden");
        notesInput.classList.add("border-red-500");
        return false;
      } else {
        notesError.textContent = "";
        notesError.classList.add("hidden");
        notesInput.classList.remove("border-red-500");
        return true;
      }
    }

    function validateDate() {
      const dateValue = dateInput.value;
      if (dateValue === "") {
        dateError.textContent = "Date is required.";
        dateError.classList.remove("hidden");
        dateInput.classList.add("border-red-500");
        return false;
      } else {
        dateError.textContent = "";
        dateError.classList.add("hidden");
        dateInput.classList.remove("border-red-500");
        return true;
      }
    }

    emailInput.addEventListener("input", validateEmail);
    notesInput.addEventListener("input", validateNotes);
    dateInput.addEventListener("input", validateDate);

    activityForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const isEmailValid = validateEmail();
      const isNotesValid = validateNotes();
      const isDateValid = validateDate();

      if (!isEmailValid || !isNotesValid || !isDateValid) {
        return;
      }
      const email = emailInput.value.trim();
      const notes = notesInput.value.trim();
      const date = dateInput.value;

      if (currentEditId) {
        const activity = activities.find(act => act.id === currentEditId);
        if (activity) {
          activity.email = email;
          activity.notes = notes;
          activity.date = date;
          activity.createdBy = email.split('@')[0];
        }
      } else {
        const newId = activities.length ? Math.max(...activities.map(a => a.id)) + 1 : 1;
        activities.push({ id: newId, email, notes, date, createdBy: email.split('@')[0], selected: false });
      }
      closePopup();
      renderTable();
    });

    /* --- Delete Confirmation Popup --- */
    function openDeletePopup(activityId) {
      currentDeleteId = activityId;
      deleteConfirmationOverlay.classList.remove("hidden");
    }
    function closeDeletePopup() {
      deleteConfirmationOverlay.classList.add("hidden");
      currentDeleteId = null;
    }
    deletePopupCloseBtn.addEventListener("click", closeDeletePopup);
    btnCancelDelete.addEventListener("click", closeDeletePopup);
    btnConfirmDelete.addEventListener("click", () => {
      if (currentDeleteId) {
        activities = activities.filter(act => act.id !== currentDeleteId);
        currentDeleteId = null;
        closeDeletePopup();
        renderTable();
      }
    });

    /* --- Update "Select All" Checkbox State for Current Page --- */
    function updateSelectAllCheckbox() {
      const startIndex = currentPage * rowsPerPage;
      const endIndex = startIndex + rowsPerPage;
      const pageData = activities.slice(startIndex, endIndex);
      const allSelected = pageData.length > 0 && pageData.every(item => item.selected);
      selectAll.checked = allSelected;
    }

    /* --- Table Rendering & Pagination --- */
    function renderTable() {
      tableBody.innerHTML = "";
      const startIndex = currentPage * rowsPerPage;
      const pageData = activities.slice(startIndex, startIndex + rowsPerPage);

      pageData.forEach(activity => {
        const row = document.createElement("tr");
        row.className = "border-b hover:bg-gray-50";

        // Checkbox cell
        const checkboxCell = document.createElement("td");
        checkboxCell.className = "p-2 text-center";
        const checkboxLabel = document.createElement("label");
        checkboxLabel.className = "custom-checkbox";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.checked = activity.selected;
        checkbox.addEventListener("change", function () {
          activity.selected = this.checked;
          updateSelectAllCheckbox();
        });
        const checkmark = document.createElement("span");
        checkmark.className = "checkmark";
        checkboxLabel.appendChild(checkbox);
        checkboxLabel.appendChild(checkmark);
        checkboxCell.appendChild(checkboxLabel);
        row.appendChild(checkboxCell);

        // Email cell
        const emailCell = document.createElement("td");
        emailCell.className = "p-2";
        emailCell.textContent = activity.email;
        emailCell.style.whiteSpace = "nowrap";
        emailCell.style.overflow = "hidden";
        emailCell.style.textOverflow = "ellipsis";
        row.appendChild(emailCell);

        // Date cell (formatted)
        const dateCell = document.createElement("td");
        dateCell.className = "p-2";
        const dateObj = new Date(activity.date);
        const month = dateObj.toLocaleString('en-US', { month: 'long' });
        const day = dateObj.getDate();
        const year = dateObj.getFullYear();
        dateCell.textContent = month + " , " + day + " ," + year;
        dateCell.style.whiteSpace = "nowrap";
        dateCell.style.overflow = "hidden";
        dateCell.style.textOverflow = "ellipsis";
        row.appendChild(dateCell);

        // Notes cell
        const notesCell = document.createElement("td");
        notesCell.className = "p-2";
        notesCell.textContent = activity.notes;
        notesCell.style.whiteSpace = "nowrap";
        notesCell.style.overflow = "hidden";
        notesCell.style.textOverflow = "ellipsis";
        row.appendChild(notesCell);

        // Created By cell
        const createdByCell = document.createElement("td");
        createdByCell.className = "p-2";
        createdByCell.textContent = activity.createdBy || activity.email.split('@')[0];
        createdByCell.style.whiteSpace = "nowrap";
        createdByCell.style.overflow = "hidden";
        createdByCell.style.textOverflow = "ellipsis";
        row.appendChild(createdByCell);

        // Action cell with Edit and Delete buttons
        const actionCell = document.createElement("td");
        const actionDiv = document.createElement("div");
        actionDiv.className = "p-2 text-center flex gap-2 items-center justify-center";

        actionDiv.className = "p-2 text-center flex gap-2 items-center justify-center";

        const editBtn = document.createElement("button");
        editBtn.innerHTML = "<div class='flex gap-2 items-center'><svg width='16' height='17' viewBox='0 0 16 17' fill='none' xmlns='http://www.w3.org/2000/svg'><g clip-path='url(#clip0_844_417)'><path d='M12.438 1.12013L4.31 9.24813C3.99956 9.55689 3.75345 9.92417 3.58592 10.3287C3.41839 10.7332 3.33276 11.167 3.334 11.6048V12.5001C3.334 12.6769 3.40424 12.8465 3.52926 12.9715C3.65428 13.0966 3.82385 13.1668 4.00066 13.1668H4.896C5.33384 13.168 5.76758 13.0824 6.1721 12.9149C6.57663 12.7473 6.9439 12.5012 7.25266 12.1908L15.3807 4.0628C15.7703 3.67224 15.9891 3.14311 15.9891 2.59146C15.9891 2.03981 15.7703 1.51068 15.3807 1.12013C14.9844 0.741392 14.4574 0.530029 13.9093 0.530029C13.3612 0.530029 12.8342 0.741392 12.438 1.12013ZM14.438 3.12013L6.31 11.2481C5.93408 11.6218 5.426 11.8321 4.896 11.8335H4.66733V11.6048C4.66872 11.0748 4.87904 10.5667 5.25266 10.1908L13.3807 2.0628C13.5231 1.92677 13.7124 1.85086 13.9093 1.85086C14.1063 1.85086 14.2956 1.92677 14.438 2.0628C14.578 2.20314 14.6566 2.39326 14.6566 2.59146C14.6566 2.78967 14.578 2.97979 14.438 3.12013Z' fill='#88B651'/><path d='M15.3333 6.486C15.1565 6.486 14.987 6.55624 14.8619 6.68126C14.7369 6.80629 14.6667 6.97586 14.6667 7.15267V10.5H12C11.4696 10.5 10.9609 10.7107 10.5858 11.0858C10.2107 11.4609 10 11.9696 10 12.5V15.1667H3.33333C2.8029 15.1667 2.29419 14.956 1.91912 14.5809C1.54405 14.2058 1.33333 13.6971 1.33333 13.1667V3.83333C1.33333 3.3029 1.54405 2.79419 1.91912 2.41912C2.29419 2.04405 2.8029 1.83333 3.33333 1.83333H9.36133C9.53815 1.83333 9.70771 1.7631 9.83274 1.63807C9.95776 1.51305 10.028 1.34348 10.028 1.16667C10.028 0.989856 9.95776 0.820286 9.83274 0.695262C9.70771 0.570238 9.53815 0.5 9.36133 0.5H3.33333C2.4496 0.501059 1.60237 0.852588 0.97748 1.47748C0.352588 2.10237 0.00105857 2.9496 0 3.83333L0 13.1667C0.00105857 14.0504 0.352588 14.8976 0.97748 15.5225C1.60237 16.1474 2.4496 16.4989 3.33333 16.5H10.8953C11.3333 16.5013 11.7671 16.4156 12.1718 16.2481C12.5764 16.0806 12.9438 15.8345 13.2527 15.524L15.0233 13.752C15.3338 13.4432 15.58 13.076 15.7477 12.6715C15.9153 12.267 16.0011 11.8332 16 11.3953V7.15267C16 6.97586 15.9298 6.80629 15.8047 6.68126C15.6797 6.55624 15.5101 6.486 15.3333 6.486ZM12.31 14.5813C12.042 14.8487 11.7031 15.0337 11.3333 15.1147V12.5C11.3333 12.3232 11.4036 12.1536 11.5286 12.0286C11.6536 11.9036 11.8232 11.8333 12 11.8333H14.6167C14.5342 12.2023 14.3493 12.5406 14.0833 12.8093L12.31 14.5813Z' fill='#88B651'/></g><defs><clipPath id='clip0_844_417'><rect width='16' height='16' fill='white' transform='translate(0 0.5)'/></clipPath></defs></svg><p>Edit</p></div>";

        editBtn.addEventListener("click", () => openPopupForEdit(activity));

        const deleteBtn = document.createElement("button");
        deleteBtn.innerHTML = "<div class='flex gap-2 items-center'><svg width='16' height='17' viewBox='0 0 16 17' fill='none' xmlns='http://www.w3.org/2000/svg'><g clip-path='url(#clip0_844_423)'><path d='M13.9987 3.16667H11.932C11.7773 2.41428 11.3679 1.73823 10.7729 1.25248C10.1778 0.766727 9.4335 0.50097 8.66536 0.5L7.33203 0.5C6.56389 0.50097 5.81958 0.766727 5.22453 1.25248C4.62948 1.73823 4.2201 2.41428 4.06536 3.16667H1.9987C1.82189 3.16667 1.65232 3.2369 1.52729 3.36193C1.40227 3.48695 1.33203 3.65652 1.33203 3.83333C1.33203 4.01014 1.40227 4.17971 1.52729 4.30474C1.65232 4.42976 1.82189 4.5 1.9987 4.5H2.66536V13.1667C2.66642 14.0504 3.01795 14.8976 3.64284 15.5225C4.26774 16.1474 5.11497 16.4989 5.9987 16.5H9.9987C10.8824 16.4989 11.7297 16.1474 12.3546 15.5225C12.9794 14.8976 13.331 14.0504 13.332 13.1667V4.5H13.9987C14.1755 4.5 14.3451 4.42976 14.4701 4.30474C14.5951 4.17971 14.6654 4.01014 14.6654 3.83333C14.6654 3.65652 14.5951 3.48695 14.4701 3.36193C14.3451 3.2369 14.1755 3.16667 13.9987 3.16667ZM7.33203 1.83333H8.66536C9.07888 1.83384 9.48212 1.96225 9.81977 2.20096C10.1574 2.43967 10.413 2.77699 10.5514 3.16667H5.44603C5.58442 2.77699 5.83996 2.43967 6.17762 2.20096C6.51528 1.96225 6.91851 1.83384 7.33203 1.83333ZM11.9987 13.1667C11.9987 13.6971 11.788 14.2058 11.4129 14.5809C11.0378 14.956 10.5291 15.1667 9.9987 15.1667H5.9987C5.46826 15.1667 4.95956 14.956 4.58448 14.5809C4.20941 14.2058 3.9987 13.6971 3.9987 13.1667V4.5H11.9987V13.1667Z' fill='#E4899C'/><path d='M6.66667 12.4996C6.84348 12.4996 7.01304 12.4293 7.13807 12.3043C7.26309 12.1793 7.33333 12.0097 7.33333 11.8329V7.83293C7.33333 7.65611 7.26309 7.48655 7.13807 7.36152C7.01304 7.2365 6.84348 7.16626 6.66667 7.16626C6.48985 7.16626 6.32029 7.2365 6.19526 7.36152C6.07024 7.48655 6 7.65611 6 7.83293V11.8329C6 12.0097 6.07024 12.1793 6.19526 12.3043C6.32029 12.4293 6.48985 12.4996 6.66667 12.4996Z' fill='#E4899C'/><path d='M9.33464 12.4996C9.51145 12.4996 9.68102 12.4293 9.80605 12.3043C9.93107 12.1793 10.0013 12.0097 10.0013 11.8329V7.83293C10.0013 7.65611 9.93107 7.48655 9.80605 7.36152C9.68102 7.2365 9.51145 7.16626 9.33464 7.16626C9.15783 7.16626 8.98826 7.2365 8.86323 7.36152C8.73821 7.48655 8.66797 7.65611 8.66797 7.83293V11.8329C8.66797 12.0097 8.73821 12.1793 8.86323 12.3043C8.98826 12.4293 9.15783 12.4996 9.33464 12.4996Z' fill='#E4899C'/></g><defs><clipPath id='clip0_844_423'><rect width='16' height='16' fill='white' transform='translate(0 0.5)'/></clipPath></defs></svg><p class='text-[#BBB6B0] '>Delete</p></div>";
        deleteBtn.addEventListener("click", () => openDeletePopup(activity.id));
        const buttonContainer = document.createElement("div");
        buttonContainer.className = "flex gap-[20px] justify-between items-center";
        buttonContainer.appendChild(editBtn);

        buttonContainer.appendChild(deleteBtn);
        actionCell.appendChild(buttonContainer);


        row.appendChild(actionCell);
        tableBody.appendChild(row);
      });
      updateSelectAllCheckbox();
      updatePagination();
    }

    function updatePagination() {
      const totalPages = Math.ceil(activities.length / rowsPerPage);
      if (currentPage === 0) {
        prevButton.disabled = true;
        prevButton.className =
          "h-[24px] p-[4px] w-[24px] rounded-[3px_0px_0px_3px] text-gray-400 bg-gray-200 cursor-not-allowed";
      } else {
        prevButton.disabled = false;
        prevButton.className =
          "h-[24px] p-[4px] w-[24px] rounded-[3px_0px_0px_3px] text-white bg-[#559BD0] cursor-pointer";
      }

      if (currentPage >= totalPages - 1) {
        nextButton.disabled = true;
        nextButton.className =
          "h-[24px] w-[24px] p-[4px]  inline-block rounded-[0px_3px_3px_0px] text-gray-400 bg-gray-200 cursor-not-allowed";
      } else {
        nextButton.disabled = false;
        nextButton.className =
          "h-[24px] w-[24px] p-[4px]  inline-block rounded-[0px_3px_3px_0px] text-white bg-[#559BD0] cursor-pointer";
      }
      updateResultsText();
    }

    function updateResultsText() {
      const totalResults = activities.length;
      const start = currentPage * rowsPerPage + 1;
      const end = Math.min((currentPage + 1) * rowsPerPage, totalResults);
      resultsText.textContent = `showing  ${end} result${totalResults > 1 ? "s" : ""}`;
    }

    prevButton.addEventListener("click", () => {
      if (currentPage > 0) {
        currentPage--;
        renderTable();
      }
    });
    nextButton.addEventListener("click", () => {
      if ((currentPage + 1) * rowsPerPage < activities.length) {
        currentPage++;
        renderTable();
      }
    });

    /* --- Sorting --- */
    document.querySelectorAll("th.sortable").forEach(th => {
      th.addEventListener("click", function () {
        const column = this.getAttribute("data-column");
        sortState[column] = -sortState[column];
        activities.sort((a, b) => {
          if (a[column] < b[column]) return -1 * sortState[column];
          if (a[column] > b[column]) return 1 * sortState[column];
          return 0;
        });
        document.querySelectorAll("th.sortable").forEach(header => header.classList.remove("asc", "desc"));
        this.classList.add(sortState[column] === 1 ? "asc" : "desc");
        renderTable();
      });
    });

    /* --- "Select All" Checkbox --- */
    selectAll.addEventListener("change", function () {
      const startIndex = currentPage * rowsPerPage;
      const endIndex = startIndex + rowsPerPage;
      const pageData = activities.slice(startIndex, endIndex);
      pageData.forEach(item => {
        item.selected = selectAll.checked;
      });
      renderTable();
    });

    /* --- Edit Popup (Populate Form) --- */
    function openPopupForEdit(activity) {
      currentEditId = activity.id;
      emailInput.value = activity.email;
      notesInput.value = activity.notes;
      dateInput.value = activity.date;
      emailError.textContent = "";
      notesError.textContent = "";
      dateError.textContent = "";
      errorMsg.textContent = "";
      popupOverlay.classList.remove("hidden");
    }

    /* --- Per Page Dropdown --- */
    perPageButton.addEventListener("click", () => {
      perPageDropdown.classList.toggle("hidden");
    });
    perPageDropdown.querySelectorAll(".option").forEach(option => {
      option.addEventListener("click", function () {
        rowsPerPage = parseInt(this.getAttribute("data-value"));
        perPageValue.textContent = rowsPerPage;
        currentPage = 0;
        renderTable();
        perPageDropdown.classList.add("hidden");
      });
    });

    // Initial table render
    renderTable();
  </script>
  <script>













































    // Define DOM elements once at the top
    const fullName = document.getElementById("fullName");
    const lastName = document.getElementById("lastName");
    const email = document.getElementById("email");
    const website = document.getElementById("website");
    const address = document.getElementById("address");
    const customerType = document.getElementById("customerType");
    const fileInput = document.getElementById("file");
    const notes = document.getElementById("notes");
    const customAlert = document.getElementById("customAlert");
    const fileDropArea = document.getElementById("fileDropArea");
    const fileInputLabel = document.getElementById("fileInputLabel");
    const fileDropAreaImage = document.getElementById("fileDropAreaImage");
    const apiError = document.getElementById("apiError");
    const customerForm = document.getElementById("customerForm");
    const submitButton = document.getElementById("submitButton");
    document.getElementById("toggleForm").addEventListener("click", toggleForm)

document.getElementById("toggleactivities").addEventListener("click",toggleactivities)
    function toggleForm(e) {
      const toggleBtn = document.getElementById("toggleForm");
      const formContainer = document.getElementById("customerFormContainer");
      const form = document.getElementById("customerForm");
      const customerBtns = document.getElementById("customerBtns");

      // حفظ المحتوى الأصلي إذا لم يُحفظ بعد
      if (!customerBtns.dataset.originalContent) {
        customerBtns.dataset.originalContent = customerBtns.innerHTML;
      }

      // حالة فتح النموذج (عند النقر على الزر أو أي عنصر آخر لإظهار النموذج)
      if (form.classList.contains("hidden")) {
        // إزالة الكلاسات المخفية لعرض النموذج والزر
        form.classList.remove("hidden");
        toggleBtn.classList.remove("hidden");
        formContainer.classList.remove("mt-[-111px]");

        // تأخير بسيط للسماح بإعادة الرسم (reflow) قبل بدء الانتقال
        setTimeout(() => {
          // إزالة تأثير التعتيم والقيود على الحاوية
          toggleBtn.classList.remove("opacity-0");
          formContainer.classList.remove("h-[89px]", "overflow-hidden");
        }, 10);

        // استعادة المحتوى الأصلي (زر الزبائن) عند فتح النموذج
        customerBtns.innerHTML = customerBtns.dataset.originalContent;

      } else {
        // حالة إغلاق النموذج
        // إضافة تأثيرات الانتقال (مثلاً تقليل الشفافية وتقييد ارتفاع الحاوية)
        toggleBtn.classList.add("opacity-0");
        customerBtns.innerHTML =''
        toggleBtn.addEventListener("transitionend", function handler(event) {
          if (event.propertyName === "opacity") {
            // إزالة المستمع لتفادي التكرار
            toggleBtn.removeEventListener("transitionend", handler);
            // إخفاء النموذج والزر بعد انتهاء الانتقال
            form.classList.add("hidden");

            // تحديث محتوى customerBtns لإظهار أيقونة جديدة
            // هذه الأيقونة تحتوي على خاصية onclick لاستدعاء الدالة مرة أخرى لعكس التغييرات
            customerBtns.innerHTML = `
          <svg onclick="toggleForm(event)" width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.675781" width="47.3239" height="47.3239" rx="11.831" fill="#559BD0"/>
            <path d="M34.197 21.6902H26.3097V13.8029C26.3097 13.2799 26.1019 12.7784 25.7321 12.4086C25.3623 12.0388 24.8608 11.8311 24.3378 11.8311C23.8149 11.8311 23.3133 12.0388 22.9435 12.4086C22.5737 12.7784 22.366 13.2799 22.366 13.8029V21.6902H14.4787C13.9557 21.6902 13.4542 21.898 13.0844 22.2677C12.7146 22.6375 12.5068 23.1391 12.5068 23.662C12.5068 24.185 12.7146 24.6865 13.0844 25.0563C13.4542 25.4261 13.9557 25.6339 14.4787 25.6339H22.366V33.5212C22.366 34.0442 22.5737 34.5457 22.9435 34.9155C23.3133 35.2853 23.8149 35.493 24.3378 35.493C24.8608 35.493 25.3623 35.2853 25.7321 34.9155C26.1019 34.5457 26.3097 34.0442 26.3097 33.5212V25.6339H34.197C34.7199 25.6339 35.2215 25.4261 35.5913 25.0563C35.9611 24.6865 36.1688 24.185 36.1688 23.662C36.1688 23.1391 35.9611 22.6375 35.5913 22.2677C35.2215 21.898 34.7199 21.6902 34.197 21.6902Z" fill="white"/>
          </svg>
        `;
          }
        });
        formContainer.classList.add("h-[89px]", "overflow-hidden");
        formContainer.classList.add("mt-[-111px]");
        
        // استخدام حدث transitionend للتأكد من انتهاء انتقال الخاصية (opacity)
     
      }
    }
    function toggleactivities(e) {
  const toggleBtn = document.getElementById("toggleactivities");
  const formContainer = document.getElementById("activitiesContainer");
  const form = document.getElementById("toggleActivitiesHidden");
  const customerBtns = document.getElementById("activitiesBtns");
  const paginationLimit = document.getElementById("paginationLimit");

  // Save original content of customerBtns if not already saved
  if (!customerBtns.dataset.originalContent) {
    customerBtns.dataset.originalContent = customerBtns.innerHTML;
  }

  // When the form is currently hidden (open it)
  if (form.classList.contains("hidden")) {
    // Remove hidden class from form and adjust layout
    form.classList.remove("hidden");
    toggleBtn.classList.remove("hidden");
    formContainer.classList.remove("mt-[-111px]");

    // Hide the paginationLimit element
    if (paginationLimit) {
      paginationLimit.classList.remove("hidden");
    }

    // Delay to allow for reflow before starting transition
    setTimeout(() => {
      toggleBtn.classList.remove("opacity-0");
      formContainer.classList.remove("h-[89px]", "overflow-hidden");
    }, 10);

    // Restore original content of customerBtns
    customerBtns.innerHTML = customerBtns.dataset.originalContent;
  } else {
            customerBtns.innerHTML = ''
    // When the form is visible (close it)
    toggleBtn.classList.add("opacity-0");
    formContainer.classList.add("h-[89px]", "overflow-hidden", "mt-[-111px]");

    // Show the paginationLimit element
    if (paginationLimit) {
      paginationLimit.classList.add("hidden");
    }

    // After the opacity transition ends, hide the form and update the button
    toggleBtn.addEventListener("transitionend", function handler(event) {
      if (event.propertyName === "opacity") {
        toggleBtn.removeEventListener("transitionend", handler);
        form.classList.add("hidden");

        // Update customerBtns with a new icon that calls toggleactivities on click
        customerBtns.innerHTML = `
          <svg onclick="toggleactivities(event)" width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="0.675781" width="47.3239" height="47.3239" rx="11.831" fill="#559BD0"/>
            <path d="M34.197 21.6902H26.3097V13.8029C26.3097 13.2799 26.1019 12.7784 25.7321 12.4086C25.3623 12.0388 24.8608 11.8311 24.3378 11.8311C23.8149 11.8311 23.3133 12.0388 22.9435 12.4086C22.5737 12.7784 22.366 13.2799 22.366 13.8029V21.6902H14.4787C13.9557 21.6902 13.4542 21.898 13.0844 22.2677C12.7146 22.6375 12.5068 23.1391 12.5068 23.662C12.5068 24.185 12.7146 24.6865 13.0844 25.0563C13.4542 25.4261 13.9557 25.6339 14.4787 25.6339H22.366V33.5212C22.366 34.0442 22.5737 34.5457 22.9435 34.9155C23.3133 35.2853 23.8149 35.493 24.3378 35.493C24.8608 35.493 25.3623 35.2853 25.7321 34.9155C26.1019 34.5457 26.3097 34.0442 26.3097 33.5212V25.6339H34.197C34.7199 25.6339 35.2215 25.4261 35.5913 25.0563C35.9611 24.6865 36.1688 24.185 36.1688 23.662C36.1688 23.1391 35.9611 22.6375 35.5913 22.2677C35.2215 21.898 34.7199 21.6902 34.197 21.6902Z" fill="white"/>
          </svg>
        `;
      }
    });
  }
}
  
    // Add skeleton class to all fields until loading
    function addSkeletonToFields() {
      document
        .querySelectorAll(
          "#customerForm input, #customerForm textarea, #customerForm select"
        )
        .forEach((field) => field.classList.add("skeleton"));
    }
    // Remove skeleton class when data is loaded
    function removeSkeletonFromFields() {
      document
        .querySelectorAll(
          "#customerForm input, #customerForm textarea, #customerForm select"
        )
        .forEach((field) => field.classList.remove("skeleton"));
    }
    addSkeletonToFields();

    let currentFileName = "";
    let phoneCounter = 1;

    function showCustomAlert() {
      customAlert.classList.remove("hidden");
    }
    function hiddenCustomAlert() {
      customAlert.classList.add("hidden");
    }

    // Validate a given field (except phone numbers)
    function validateField(field) {
      const errorDiv = document.getElementById(field.id + "Error");
      let valid = true;

      if (field.tagName.toLowerCase() === "select") {
        valid = field.value !== "";
      } else if (field.type === "email") {
        valid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(field.value);
      } else if (field.type === "url") {
        valid = /^https?:\/\/.+\..+/.test(field.value);
      } else if (field.type === "file") {
        if (field.files && field.files.length > 0) {
          const file = field.files[0];
          if (file.size > 2 * 1024 * 1024) {
            valid = false;
            if (errorDiv) errorDiv.innerText = "File must be less than 2MB.";
          } else if (
            !["application/pdf", "image/jpeg", "image/png"].includes(
              file.type
            )
          ) {
            valid = false;
            if (errorDiv)
              errorDiv.innerText = "File must be a PDF or JPG/PNG.";
          } else {
            valid = true;
            if (errorDiv) errorDiv.innerText = "";
          }
        } else {
          valid = currentFileName !== "";
          if (!valid && errorDiv)
            errorDiv.innerText = "This field is required.";
        }
      } else {
        valid = field.value.trim() !== "";
      }

      if (valid) {
        field.classList.remove("error");
        if (field.type === "file")
          fileDropArea.classList.remove("border-red-500");
        if (errorDiv) errorDiv.style.display = "none";
      }
      return valid;
    }

    function addValidationListener(field) {
      if (field.tagName.toLowerCase() === "select" || field.type === "file") {
        field.addEventListener("change", () => validateField(field));
      } else {
        field.addEventListener("input", () => validateField(field));
      }
    }

    // Attach validation for all standard fields using the IDs defined above
    [
      "fullName",
      "lastName",
      "email",
      "website",
      "address",
      "customerType",
      "file",
      "notes",
    ].forEach((id) => {
      const field = document.getElementById(id);
      addValidationListener(field);
    });

    const defaultSVG = `<svg width="103" height="102" viewBox="0 0 103 102" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- SVG content truncated for brevity -->
    </svg>`;
    const pdfIconSVG = `<svg width="100" height="100" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- SVG content truncated for brevity -->
    </svg>`;
    const wordIconSVG = `<svg width="100" height="100" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- SVG content truncated for brevity -->
    </svg>`;

    // Drag & drop file functionality using the pre-defined variables
    fileDropArea.addEventListener("click", () => fileInput.click());
    fileDropArea.addEventListener("dragover", (e) => {
      e.preventDefault();
      fileDropArea.classList.add("bg-blue-100");
    });
    fileDropArea.addEventListener("dragleave", (e) => {
      e.preventDefault();
      fileDropArea.classList.remove("bg-blue-100");
    });
    fileDropArea.addEventListener("drop", (e) => {
      e.preventDefault();
      fileDropArea.classList.remove("bg-blue-100");
      if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {
        fileInput.files = e.dataTransfer.files;
        handleFileChange();
      }
    });
    fileInput.addEventListener("change", handleFileChange);

    function handleFileChange() {
      if (fileInput.files && fileInput.files.length > 0) {
        const file = fileInput.files[0];
        currentFileName = file.name;
        fileInputLabel.textContent = "Selected File: " + currentFileName;
        // Check file type and update preview
        if (file.type.startsWith("image/")) {
          const reader = new FileReader();
          reader.onload = function (e) {
            fileDropAreaImage.innerHTML = `<img src="${e.target.result}" alt="Image Preview" class="max-w-full max-h-[200px]" />`;
          };
          reader.readAsDataURL(file);
        } else if (file.type === "application/pdf") {
          fileDropAreaImage.innerHTML = pdfIconSVG;
        } else if (
          file.type === "application/msword" ||
          file.type ===
          "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
        ) {
          fileDropAreaImage.innerHTML = wordIconSVG;
        } else {
          fileDropAreaImage.innerHTML = defaultSVG;
        }
      } else {
        currentFileName = "";
        fileInputLabel.textContent = "Drag & Drop your file or Browse";
        fileDropAreaImage.innerHTML = defaultSVG;
      }
      validateField(fileInput);
    }

    // Phone field validation
    function attachPhoneValidation(input) {
      input.addEventListener("input", () => {
        const phoneGroup = input.closest(".phone-group");
        const errorDiv = phoneGroup.querySelector(".phone-error");
        if (input.value.trim() !== "") {
          input.classList.remove("error");
          errorDiv.style.display = "none";
        } else {
          input.classList.add("error");
          errorDiv.style.display = "block";
        }
      });
    }
    document.querySelectorAll(".phone").forEach((input) => {
      attachPhoneValidation(input);
    });

    // Add a new phone field
    function addPhoneNumber() {
      const phoneContainer = document.getElementById("phoneNumbers");
      if (!phoneContainer) {
        console.error("phoneNumbers container not found");
        return;
      }
      const newDiv = document.createElement("div");
      newDiv.className = "phone-group relative flex flex-col";

      const newInput = document.createElement("input");
      newInput.type = "tel";
      newInput.placeholder = " ";
      newInput.className = "phone floating-input peer ";
      const newId = "phone" + phoneCounter;
      newInput.id = newId;

      const newLabel = document.createElement("label");
      newLabel.htmlFor = newId;
      newLabel.className = "floating-label";
      newLabel.innerText = "Phone Number";

      const errorDiv = document.createElement("div");
      errorDiv.className = "error-message phone-error mt-1";
      errorDiv.innerText = "This field is required.";

      newDiv.appendChild(newInput);
      newDiv.appendChild(newLabel);
      newDiv.appendChild(errorDiv);

      const iconContainer = document.createElement("div");
      iconContainer.className = "flex items-center justify-between mt-2";
      const deleteDiv = document.createElement("div");
      deleteDiv.className =
        "flex items-center gap-1 deleteBtn cursor-pointer";
      deleteDiv.innerHTML = `
         <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_809_4373)">
<path d="M13.9987 2.84928H11.932C11.7773 2.09689 11.3679 1.42085 10.7729 0.935096C10.1778 0.449344 9.4335 0.183587 8.66536 0.182617L7.33203 0.182617C6.56389 0.183587 5.81958 0.449344 5.22453 0.935096C4.62948 1.42085 4.2201 2.09689 4.06536 2.84928H1.9987C1.82189 2.84928 1.65232 2.91952 1.52729 3.04455C1.40227 3.16957 1.33203 3.33914 1.33203 3.51595C1.33203 3.69276 1.40227 3.86233 1.52729 3.98735C1.65232 4.11238 1.82189 4.18262 1.9987 4.18262H2.66536V12.8493C2.66642 13.733 3.01795 14.5802 3.64284 15.2051C4.26774 15.83 5.11497 16.1816 5.9987 16.1826H9.9987C10.8824 16.1816 11.7297 15.83 12.3546 15.2051C12.9794 14.5802 13.331 13.733 13.332 12.8493V4.18262H13.9987C14.1755 4.18262 14.3451 4.11238 14.4701 3.98735C14.5951 3.86233 14.6654 3.69276 14.6654 3.51595C14.6654 3.33914 14.5951 3.16957 14.4701 3.04455C14.3451 2.91952 14.1755 2.84928 13.9987 2.84928ZM7.33203 1.51595H8.66536C9.07888 1.51646 9.48212 1.64487 9.81977 1.88358C10.1574 2.12229 10.413 2.45961 10.5514 2.84928H5.44603C5.58442 2.45961 5.83996 2.12229 6.17762 1.88358C6.51528 1.64487 6.91851 1.51646 7.33203 1.51595ZM11.9987 12.8493C11.9987 13.3797 11.788 13.8884 11.4129 14.2635C11.0378 14.6386 10.5291 14.8493 9.9987 14.8493H5.9987C5.46826 14.8493 4.95956 14.6386 4.58448 14.2635C4.20941 13.8884 3.9987 13.3797 3.9987 12.8493V4.18262H11.9987V12.8493Z" fill="#E4899C"/>
<path d="M6.66667 12.1822C6.84348 12.1822 7.01304 12.112 7.13807 11.9869C7.26309 11.8619 7.33333 11.6923 7.33333 11.5155V7.51554C7.33333 7.33873 7.26309 7.16916 7.13807 7.04414C7.01304 6.91911 6.84348 6.84888 6.66667 6.84888C6.48985 6.84888 6.32029 6.91911 6.19526 7.04414C6.07024 7.16916 6 7.33873 6 7.51554V11.5155C6 11.6923 6.07024 11.8619 6.19526 11.9869C6.32029 12.112 6.48985 12.1822 6.66667 12.1822Z" fill="#E4899C"/>
<path d="M9.33464 12.1822C9.51145 12.1822 9.68102 12.112 9.80605 11.9869C9.93107 11.8619 10.0013 11.6923 10.0013 11.5155V7.51554C10.0013 7.33873 9.93107 7.16916 9.80605 7.04414C9.68102 6.91911 9.51145 6.84888 9.33464 6.84888C9.15783 6.84888 8.98826 6.91911 8.86323 7.04414C8.73821 7.16916 8.66797 7.33873 8.66797 7.51554V11.5155C8.66797 11.6923 8.73821 11.8619 8.86323 11.9869C8.98826 12.112 9.15783 12.1822 9.33464 12.1822Z" fill="#E4899C"/>
</g>
<defs>
<clipPath id="clip0_809_4373">
<rect width="16" height="16" fill="white" transform="translate(0 0.182617)"/>
</clipPath>
</defs>
</svg>

          <p class='text-[12px] text-[#BBB6B0] font-[600]'>Delete</p>
        `;
      iconContainer.appendChild(deleteDiv);
      newDiv.appendChild(iconContainer);

      deleteDiv.onclick = function () {
        newDiv.remove();
      };

      const addBtnContainer =
        phoneContainer.querySelector(".phone-container");
      if (addBtnContainer) {
        phoneContainer.insertBefore(newDiv, addBtnContainer);
      } else {
        phoneContainer.appendChild(newDiv);
      }
      attachPhoneValidation(newInput);
      phoneCounter++;
      return newInput;
    }

    // Simulate sending FormData to an API
    function sendData(formData) {
      return new Promise((resolve) => {
        setTimeout(() => {
          const errorOccurs = Math.random() < 0.5;
          if (errorOccurs) {
            resolve({ error: "API Error: Unable to update customer data." });
          } else {
            resolve({ success: true });
            showCustomAlert();
            setTimeout(() => {
              hiddenCustomAlert();
            }, 2000);
          }
        }, 500);
      });
    }

    // Use defined variables for event listeners instead of document.getElementById
    customerType.addEventListener("input", function (e) {
      e.target.value && customerType.classList.add("float");
    });

    customerForm.addEventListener("submit", function (event) {
      event.preventDefault();
      apiError.classList.add("hidden");

      let firstError = null;
      const fields = [
        fullName,
        lastName,
        email,
        website,
        address,
        customerType,
        fileInput,
        notes,
      ];

      fields.forEach((field) => {
        if (!validateField(field)) {
          field.classList.add("error");
          if (field.type === "file")
            fileDropArea.classList.add("border-red-500");
          const errorDiv = document.getElementById(field.id + "Error");
          errorDiv.style.display = "block";
          if (!firstError) firstError = field;
        }
      });

      // Validate phone fields
      document.querySelectorAll(".phone").forEach((input) => {
        const phoneGroup = input.closest(".phone-group");
        const errorDiv = phoneGroup.querySelector(".phone-error");
        if (input.value.trim() === "") {
          input.classList.add("error");
          errorDiv.style.display = "block";
          if (!firstError) firstError = input;
        }
      });

      if (firstError) {
        firstError.focus();
      } else {
        submitButton.disabled = true;
        submitButton.innerText = "Create...";

        const formData = new FormData();
        formData.append("fullName", fullName.value);
        formData.append("lastName", lastName.value);
        formData.append("email", email.value);
        formData.append("website", website.value);
        formData.append("address", address.value);
        formData.append("customerType", customerType.value);
        formData.append("notes", notes.value);

        if (fileInput.files && fileInput.files.length > 0) {
          formData.append("file", fileInput.files[0]);
        } else {
          formData.append("file", currentFileName);
        }

        document.querySelectorAll(".phone").forEach((input, index) => {
          formData.append(`phoneNumbers[${index}]`, input.value);
        });

        sendData(formData).then((response) => {
          submitButton.disabled = false;
          submitButton.innerText = "Submit";

          if (response.error) {
            apiError.classList.remove("hidden");
            apiError.innerText = response.error;
            apiError.scrollIntoView({ behavior: "smooth", block: "center" });
          } else {
            apiError.classList.add("hidden");
            apiError.innerText = "";
            const data = {};
            formData.forEach((value, key) => {
              data[key] = value;
            });
            console.log("Form Data:", data);

          }
        });
      }
    });

    // Populate the form fields with fetched dummy data using the defined variables
    function populateForm(data) {
      fullName.value = data.fullName;
      lastName.value = data.lastName;
      email.value = data.email;
      website.value = data.website;
      address.value = data.address;
      customerType.value = data.customerType;
      if (data.customerType) customerType.classList.add("float");

      currentFileName = data.fileName || "";
      fileInputLabel.textContent = currentFileName
        ? "Current File: " + currentFileName
        : "Drag&Drop your file or Browse";

      notes.value = data.notes;
      if (data.phoneNumbers && data.phoneNumbers.length > 0) {
        const initialPhone = document.querySelector(".phone");
        initialPhone.value = data.phoneNumbers[0];
        for (let i = 1; i < data.phoneNumbers.length; i++) {
          let newPhoneInput = addPhoneNumber();
          newPhoneInput.value = data.phoneNumbers[i];
        }
      }
      removeSkeletonFromFields();
    }

    // Simulate fetching data
    function fetchDummyData() {
      return new Promise((resolve) => {
        setTimeout(() => {
          resolve({
            fullName: "John",
            lastName: "Doe",
            email: "john.doe@example.com",
            website: "https://example.com",
            address: "123 Main Street",
            customerType: "vip",
            phoneNumbers: ["123456789", "987654321"],
            fileName: "dummy.pdf",
            notes: "Sample notes for update.",
          });
        }, 1500);
      });
    }

    fetchDummyData().then((data) => {
      populateForm(data);
    });

    // handle table
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
</body>

</html>